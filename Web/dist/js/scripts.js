var app=angular.module("app",["ui.router"]),CONSTANTS=function(){var r={};return r.API_BASE_URL="http://discoverbandapi.int/public/api",r}();app.config(["$stateProvider","$urlRouterProvider",function(r,e){e.otherwise("/"),r.state("home",{url:"/",templateUrl:"app/pages/home.html",controller:"homeController as home"}).state("solo",{url:"/solo",templateUrl:"app/pages/solo.html",controller:"soloController as solo"}).state("merged",{url:"/merged",templateUrl:"app/pages/merged.html",controller:"mergedController as merged"}).state("band",{url:"/band",templateUrl:"app/pages/band.html",controller:"bandController as band"}).state("merge",{url:"/merge",templateUrl:"app/pages/merge.html",controller:"mergeController as merge"})}]),app.controller("bandController",["bandService",function(r){function e(){t.gg=a.testValue}var t=this,a=r;e()}]),app.controller("homeController",["instrumentService","filterService",function(r,e){function t(){a.filterData=n.filterData}var a=this,n=e;t()}]),app.controller("mergeController",function(){function r(){}r()}),app.controller("mergedController",function(){function r(){e.test="Merged"}var e=this;r()}),app.controller("soloController",["$scope","bandService","soloService","instrumentService","filterService",function(r,e,t,a,n){function o(){d.getTracks().then(function(r){s.soloTracks=r.data,s.filteredTracks=s.soloTracks,i()},function(r){console.log(r)})}function i(){s.filteredTracks=[],angular.forEach(s.soloTracks,function(r,e){goodSearch=!0,""!=!s.filterData.artist||r.artist.name.match(new RegExp(s.filterData.artist,"i"))||(goodSearch=!1),""!=!s.filterData.title||r.songname.match(new RegExp(s.filterData.title,"i"))||(goodSearch=!1),s.filterData[r.instrument_id]||(goodSearch=!1),goodSearch&&s.filteredTracks.push(r)})}function c(r,e,t){for(var a=0,n=r.length;a<n;a++)if(r[a][t]===e)return a;return-1}function l(){o(),s.instruments=f.instruments,s.filterData=p.filterData,s.bandTrackIdArray=[],angular.forEach(u.trackArray,function(r,e){s.bandTrackIdArray.push(r.id)})}var s=this,u=e,d=t,f=a,p=n;s.addToBand=function(r){u.trackArray.push(r),angular.forEach(u.trackArray,function(r,e){s.bandTrackIdArray.push(r.id)}),console.log("Track added to new band: "+r),console.log(u.trackArray)},s.removeFromBand=function(r){index=c(u.trackArray,r.id,"id"),index>-1&&(u.trackArray.splice(index,1),s.bandTrackArray=u.trackArray,intIndex=s.bandTrackIdArray.indexOf(r.id),intIndex>-1&&s.bandTrackIdArray.splice(intIndex,1)),console.log("Track removed from new band: "+r),console.log(u.trackArray)},r.$watch(function(){return s.filterData},function(){s.filterData&&i()},!0),s.track1=new Audio("dist/audio/Behemoth - Conquer All - Drum.mp3"),s.track2=new Audio("dist/audio/Behemoth - Conquer All - Guitar.mp3"),l()}]),app.filter("band",function(){return function(r,e){var t=!1;return angular.forEach(e,function(e,a){e==r&&(t=!0)}),t}}),app.service("bandService",function(){var r=this;r.testValue="This value is from a service!",r.trackArray=[],r.testFunction=function(){alert("Test function called from inside service!")}}),app.service("filterService",["instrumentService",function(r){function e(){t.createFilterData()}var t=this,a=r;t.createFilterData=function(){t.filterData={artist:"",title:""},angular.forEach(a.instruments,function(r,e){t.filterData[r.id]=!0})},e()}]),app.service("instrumentService",["$http",function(r){function e(e,t){return t?"":t={},r.get(e,t)}var t=this;t.getInstruments=function(){var r=CONSTANTS.API_BASE_URL+"/instruments";t.instruments=e(r)},t.instruments=[{name:"Lead-guitar",id:1},{name:"Drum",id:2},{name:"Bass",id:3},{name:"Keys",id:4}]}]),app.service("soloService",["$http",function(r){function e(e,t){return t?"":t={},r.get(e,t)}var t=this;t.getTracks=function(){var r=CONSTANTS.API_BASE_URL+"/tracks";return e(r)},t.getTrackById=function(r){var t=CONSTANTS.API_BASE_URL+"/tracks/"+r;return e(t)}}]),app.directive("dcbHeader",function(){return{restrict:"E",templateUrl:"app/directives/dcb-header/dcb-header.html",replace:!0,scope:{},controllerAs:"head",controller:function(){function r(){e.value="This is a directive test value!"}var e=this;r()}}}),app.directive("dcbBand",["bandService",function(r){return{restrict:"E",templateUrl:"app/directives/dcb-band/dcb-band.html",replace:!0,scope:{},controllerAs:"band",controller:function(){function r(){e.value="NewBand"}var e=this;r()}}}]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNvbmZpZy5qcyIsInJvdXRlcy5qcyIsImJhbmRDb250cm9sbGVyLmpzIiwiaG9tZUNvbnRyb2xsZXIuanMiLCJtZXJnZUNvbnRyb2xsZXIuanMiLCJtZXJnZWRDb250cm9sbGVyLmpzIiwic29sb0NvbnRyb2xsZXIuanMiLCJiYW5kRmlsdGVyLmpzIiwiYmFuZFNlcnZpY2UuanMiLCJmaWx0ZXJTZXJ2aWNlLmpzIiwiaW5zdHJ1bWVudFNlcnZpY2UuanMiLCJzb2xvU2VydmljZS5qcyIsImRjYi1oZWFkZXIvZGNiLWhlYWRlci5qcyIsImRjYi1iYW5kL2RjYi1iYW5kLmpzIl0sIm5hbWVzIjpbImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJDT05TVEFOVFMiLCJBUElfQkFTRV9VUkwiLCJjb25maWciLCIkc3RhdGVQcm92aWRlciIsIiR1cmxSb3V0ZXJQcm92aWRlciIsIm90aGVyd2lzZSIsInN0YXRlIiwidXJsIiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwiYmFuZFNlcnZpY2UiLCJfaW5pdCIsInZtIiwiZ2ciLCJiYW5kU3ZjIiwidGVzdFZhbHVlIiwidGhpcyIsImluc3RydW1lbnRTZXJ2aWNlIiwiZmlsdGVyU2VydmljZSIsImZpbHRlckRhdGEiLCJmbHRTdmMiLCJ0ZXN0IiwiJHNjb3BlIiwic29sb1NlcnZpY2UiLCJnZXRTb2xvVHJhY2tzIiwic29sb1N2YyIsImdldFRyYWNrcyIsInRoZW4iLCJkYXRhIiwic29sb1RyYWNrcyIsImZpbHRlcmVkVHJhY2tzIiwiZmlsdGVyIiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwiZm9yRWFjaCIsInRyYWNrIiwia2V5IiwiZ29vZFNlYXJjaCIsImFydGlzdCIsIm5hbWUiLCJtYXRjaCIsIlJlZ0V4cCIsInRpdGxlIiwic29uZ25hbWUiLCJpbnN0cnVtZW50X2lkIiwicHVzaCIsImFycmF5T2JqZWN0SW5kZXhPZiIsIm15QXJyYXkiLCJzZWFyY2hUZXJtIiwicHJvcGVydHkiLCJpIiwibGVuIiwibGVuZ3RoIiwiaW5zdHJ1bWVudHMiLCJpbnN0U3ZjIiwiYmFuZFRyYWNrSWRBcnJheSIsInRyYWNrQXJyYXkiLCJpZCIsImFkZFRvQmFuZCIsInJlbW92ZUZyb21CYW5kIiwiaW5kZXgiLCJzcGxpY2UiLCJiYW5kVHJhY2tBcnJheSIsImludEluZGV4IiwiaW5kZXhPZiIsIiR3YXRjaCIsInRyYWNrMSIsIkF1ZGlvIiwidHJhY2syIiwidHJhY2tJZCIsImxpc3QiLCJyZXR1cm5WYWx1ZSIsInNlcnZpY2UiLCJzdmMiLCJ0ZXN0RnVuY3Rpb24iLCJhbGVydCIsImNyZWF0ZUZpbHRlckRhdGEiLCJ2YWx1ZSIsIiRodHRwIiwiZ2V0RGF0YSIsIm9wdGlvbnMiLCJnZXQiLCJnZXRJbnN0cnVtZW50cyIsImdldFRyYWNrQnlJZCIsImRpcmVjdGl2ZSIsInJlc3RyaWN0IiwicmVwbGFjZSIsInNjb3BlIiwiY29udHJvbGxlckFzIl0sIm1hcHBpbmdzIjoiQUFBQSxHQUFJQSxLQUFNQyxRQUFRQyxPQUFPLE9BQVEsY0NBN0JDLFVBQWEsV0FFaEIsR0FBSUQsS0FJSixPQUZBQSxHQUFPRSxhQUFlLHdDQUVmRixJQ05SRixLQUFJSyxRQUFBLGlCQUFBLHFCQUFPLFNBQVNDLEVBQWdCQyxHQUNsQ0EsRUFBbUJDLFVBQVUsS0FFN0JGLEVBQ0dHLE1BQU0sUUFDTEMsSUFBSyxJQUNMQyxZQUFhLHNCQUNiQyxXQUFZLDJCQUVkSCxNQUFNLFFBQ0pDLElBQUssUUFDTEMsWUFBYSxzQkFDYkMsV0FBWSwyQkFFYkgsTUFBTSxVQUNMQyxJQUFLLFVBQ0xDLFlBQWEsd0JBQ2JDLFdBQVksK0JBRWJILE1BQU0sUUFDTEMsSUFBSyxRQUNMQyxZQUFhLHNCQUNiQyxXQUFZLDJCQUViSCxNQUFNLFNBQ0xDLElBQUssU0FDTEMsWUFBYSx1QkFDYkMsV0FBWSxnQ0MzQmxCWixJQUFJWSxXQUFXLGtCQUFBLGNBQWtCLFNBQVNDLEdBS3pDLFFBQVNDLEtBQ1JDLEVBQUdDLEdBQUtDLEVBQVFDLFVBSmpCLEdBQUlILEdBQUtJ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S0FFSkYsRUFBTUcsSUFBSTNFLEVBQUswRSxHQVB2QixHQUFJUCxHQUFNMUQsSUFXVjBELEdBQUloRCxVQUFZLFdBRWYsR0FBSW5CLEdBQU1QLFVBQVVDLGFBQWUsU0FFbkMsT0FBTytFLEdBQVF6RSxJQUdoQm1FLEVBQUlVLGFBQWUsU0FBVTFCLEdBRTVCLEdBQUluRCxHQUFNUCxVQUFVQyxhQUFlLFdBQWF5RCxDQUVoRCxPQUFPc0IsR0FBUXpFLE9DekJqQlYsSUFBSXdGLFVBQVUsWUFBYSxXQUMxQixPQUNDQyxTQUFVLElBQ1Y5RSxZQUFhLDRDQUNiK0UsU0FBUyxFQUNUQyxTQUNBQyxhQUFjLE9BQ2RoRixXQUFZLFdBR1gsUUFBU0UsS0FDUkMsRUFBR2tFLE1BQVEsa0NBSFosR0FBSWxFLEdBQUtJLElBTVRMLFNDZEhkLElBQUl3RixVQUFVLFdBQUEsY0FBVyxTQUFTM0UsR0FDakMsT0FDQzRFLFNBQVUsSUFDVjlFLFlBQWEsd0NBQ2IrRSxTQUFTLEVBQ1RDLFNBQ0FDLGFBQWMsT0FDZGhGLFdBQVksV0FJWCxRQUFTRSxLQUNSQyxFQUFHa0UsTUFBUSxVQUpaLEdBQUlsRSxHQUFLSSxJQU9UTCIsImZpbGUiOiJzY3JpcHRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKFwiYXBwXCIsIFtcInVpLnJvdXRlclwiXSk7IiwidmFyIENPTlNUQU5UUyA9IChmdW5jdGlvbiAoKSB7XG5cdFxuXHR2YXIgbW9kdWxlID0ge307XG5cblx0bW9kdWxlLkFQSV9CQVNFX1VSTCA9IFwiaHR0cDovL2Rpc2NvdmVyYmFuZGFwaS5pbnQvcHVibGljL2FwaVwiO1xuXG5cdHJldHVybiBtb2R1bGU7XG59KCkpOyIsImFwcC5jb25maWcoZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xuICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKFwiL1wiKTtcblxuICAkc3RhdGVQcm92aWRlclxuICAgIC5zdGF0ZSgnaG9tZScsIHtcbiAgICAgIHVybDogXCIvXCIsXG4gICAgICB0ZW1wbGF0ZVVybDogXCJhcHAvcGFnZXMvaG9tZS5odG1sXCIsXG4gICAgICBjb250cm9sbGVyOiBcImhvbWVDb250cm9sbGVyIGFzIGhvbWVcIlxuICAgIH0pXG4gIFx0LnN0YXRlKCdzb2xvJywge1xuICAgICAgdXJsOiBcIi9zb2xvXCIsXG4gICAgICB0ZW1wbGF0ZVVybDogXCJhcHAvcGFnZXMvc29sby5odG1sXCIsXG4gICAgICBjb250cm9sbGVyOiBcInNvbG9Db250cm9sbGVyIGFzIHNvbG9cIlxuICAgIH0pXG4gICAgLnN0YXRlKCdtZXJnZWQnLCB7XG4gICAgICB1cmw6IFwiL21lcmdlZFwiLFxuICAgICAgdGVtcGxhdGVVcmw6IFwiYXBwL3BhZ2VzL21lcmdlZC5odG1sXCIsXG4gICAgICBjb250cm9sbGVyOiBcIm1lcmdlZENvbnRyb2xsZXIgYXMgbWVyZ2VkXCJcbiAgICB9KVxuICAgIC5zdGF0ZSgnYmFuZCcsIHtcbiAgICAgIHVybDogXCIvYmFuZFwiLFxuICAgICAgdGVtcGxhdGVVcmw6IFwiYXBwL3BhZ2VzL2JhbmQuaHRtbFwiLFxuICAgICAgY29udHJvbGxlcjogXCJiYW5kQ29udHJvbGxlciBhcyBiYW5kXCJcbiAgICB9KVxuICAgIC5zdGF0ZSgnbWVyZ2UnLCB7XG4gICAgICB1cmw6IFwiL21lcmdlXCIsXG4gICAgICB0ZW1wbGF0ZVVybDogXCJhcHAvcGFnZXMvbWVyZ2UuaHRtbFwiLFxuICAgICAgY29udHJvbGxlcjogXCJtZXJnZUNvbnRyb2xsZXIgYXMgbWVyZ2VcIlxuICAgIH0pXG59KTsiLCJhcHAuY29udHJvbGxlcihcImJhbmRDb250cm9sbGVyXCIsIGZ1bmN0aW9uKGJhbmRTZXJ2aWNlKSB7XG5cdFxuXHR2YXIgdm0gPSB0aGlzO1xuXHR2YXIgYmFuZFN2YyA9IGJhbmRTZXJ2aWNlO1xuXG5cdGZ1bmN0aW9uIF9pbml0KCkge1xuXHRcdHZtLmdnID0gYmFuZFN2Yy50ZXN0VmFsdWU7XG5cdH1cblxuXHRfaW5pdCgpO1xufSk7IiwiYXBwLmNvbnRyb2xsZXIoXCJob21lQ29udHJvbGxlclwiLCBmdW5jdGlvbihpbnN0cnVtZW50U2VydmljZSwgZmlsdGVyU2VydmljZSkge1xuXHRcblx0dmFyIHZtID0gdGhpcztcblx0dmFyIGluc3RTdmMgPSBpbnN0cnVtZW50U2VydmljZTtcblx0dmFyIGZsdFN2YyA9IGZpbHRlclNlcnZpY2U7XG5cblx0ZnVuY3Rpb24gX2luaXQoKSB7XG5cdFx0Ly9pbnN0U3ZjLmdldEluc3RydW1lbnRzKCk7XG5cblx0XHR2bS5maWx0ZXJEYXRhID0gZmx0U3ZjLmZpbHRlckRhdGE7XG5cdH1cblxuXHRfaW5pdCgpO1xufSk7IiwiYXBwLmNvbnRyb2xsZXIoXCJtZXJnZUNvbnRyb2xsZXJcIiwgZnVuY3Rpb24oKSB7XG5cdHZhciB2bSA9IHRoaXM7XG5cblx0ZnVuY3Rpb24gX2luaXQoKSB7XG5cdFx0XG5cdH1cblxuXHRfaW5pdCgpO1xufSk7IiwiYXBwLmNvbnRyb2xsZXIoXCJtZXJnZWRDb250cm9sbGVyXCIsIGZ1bmN0aW9uKCkge1xuXHR2YXIgdm0gPSB0aGlzO1xuXG5cdGZ1bmN0aW9uIF9pbml0KCkge1xuXHRcdHZtLnRlc3QgPSBcIk1lcmdlZFwiO1xuXHR9XG5cblx0X2luaXQoKTtcbn0pOyIsImFwcC5jb250cm9sbGVyKFwic29sb0NvbnRyb2xsZXJcIiwgZnVuY3Rpb24oJHNjb3BlLCBiYW5kU2VydmljZSwgc29sb1NlcnZpY2UsIGluc3RydW1lbnRTZXJ2aWNlLCBmaWx0ZXJTZXJ2aWNlKSB7XG5cdFxuXHR2YXIgdm0gPSB0aGlzO1xuXHR2YXIgYmFuZFN2YyA9IGJhbmRTZXJ2aWNlO1xuXHR2YXIgc29sb1N2YyA9IHNvbG9TZXJ2aWNlO1xuXHR2YXIgaW5zdFN2YyA9IGluc3RydW1lbnRTZXJ2aWNlO1xuXHR2YXIgZmx0U3ZjID0gZmlsdGVyU2VydmljZTtcblxuXHQvL1ByaXZhdGUgZnVuY3Rpb25zXG5cdGZ1bmN0aW9uIHBsYXlBdWRpb0ZpbGUodHJhY2spXG5cdHtcblx0XHR0cmFjay5wbGF5KCk7XG5cdH1cblxuXHRmdW5jdGlvbiBnZXRTb2xvVHJhY2tzKClcblx0e1xuXHRcdHNvbG9TdmMuZ2V0VHJhY2tzKClcblx0XHRcdC50aGVuKGZ1bmN0aW9uKGRhdGEpXG5cdFx0XHR7XG5cdFx0XHRcdHZtLnNvbG9UcmFja3MgPSBkYXRhLmRhdGE7XG5cdFx0XHRcdHZtLmZpbHRlcmVkVHJhY2tzID0gdm0uc29sb1RyYWNrcztcblx0XHRcdFx0ZmlsdGVyKCk7XG5cdFx0XHRcblx0XHRcdH0sIGZ1bmN0aW9uKGVycm9yKVxuXHRcdFx0e1xuXHRcdFx0XHRjb25zb2xlLmxvZyhlcnJvcik7XG5cdFx0XHR9KTtcblx0fVxuXG5cdGZ1bmN0aW9uIGZpbHRlcigpXG5cdHtcblx0XHR2bS5maWx0ZXJlZFRyYWNrcyA9IFtdO1xuXG5cdFx0YW5ndWxhci5mb3JFYWNoKHZtLnNvbG9UcmFja3MsIGZ1bmN0aW9uKHRyYWNrLCBrZXkpXG5cdFx0e1xuXHRcdFx0Ly9jb25zb2xlLmxvZyh0cmFjayk7XG5cdFx0XHRnb29kU2VhcmNoID0gdHJ1ZTtcblxuXHRcdFx0aWYoIXZtLmZpbHRlckRhdGEuYXJ0aXN0ID09IFwiXCIgJiYgIXRyYWNrLmFydGlzdC5uYW1lLm1hdGNoKG5ldyBSZWdFeHAodm0uZmlsdGVyRGF0YS5hcnRpc3QsIFwiaVwiKSkpXG5cdFx0XHR7XG5cdFx0XHRcdGdvb2RTZWFyY2ggPSBmYWxzZTtcblx0XHRcdH1cblxuXHRcdFx0aWYoIXZtLmZpbHRlckRhdGEudGl0bGUgPT0gXCJcIiAmJiAhdHJhY2suc29uZ25hbWUubWF0Y2gobmV3IFJlZ0V4cCh2bS5maWx0ZXJEYXRhLnRpdGxlLCBcImlcIikpKVxuXHRcdFx0e1xuXHRcdFx0XHRnb29kU2VhcmNoID0gZmFsc2U7XG5cdFx0XHR9XG5cblx0XHRcdGlmKCF2bS5maWx0ZXJEYXRhW3RyYWNrLmluc3RydW1lbnRfaWRdKVxuXHRcdFx0e1xuXHRcdFx0XHRnb29kU2VhcmNoID0gZmFsc2U7XG5cdFx0XHR9XG5cblxuXHRcdFx0aWYoZ29vZFNlYXJjaClcblx0XHRcdHtcblx0XHRcdFx0dm0uZmlsdGVyZWRUcmFja3MucHVzaCh0cmFjayk7XG5cdFx0XHR9XG5cdFx0XHQvL2NvbnNvbGUubG9nKHZtLmZpbHRlcmVkVHJhY2tzKTtcblx0XHR9KTtcblx0fVxuXG5cdGZ1bmN0aW9uIGFycmF5T2JqZWN0SW5kZXhPZihteUFycmF5LCBzZWFyY2hUZXJtLCBwcm9wZXJ0eSkge1xuICAgIFx0XG4gICAgXHRmb3IodmFyIGkgPSAwLCBsZW4gPSBteUFycmF5Lmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIFx0aWYgKG15QXJyYXlbaV1bcHJvcGVydHldID09PSBzZWFyY2hUZXJtKSByZXR1cm4gaTtcbiAgICBcdH1cblxuICAgIFx0cmV0dXJuIC0xO1xuXHR9XG5cblx0ZnVuY3Rpb24gX2luaXQoKSB7XG5cdFx0Z2V0U29sb1RyYWNrcygpO1xuXHRcdHZtLmluc3RydW1lbnRzID0gaW5zdFN2Yy5pbnN0cnVtZW50cztcblx0XHR2bS5maWx0ZXJEYXRhID0gZmx0U3ZjLmZpbHRlckRhdGE7XG5cdFx0dm0uYmFuZFRyYWNrSWRBcnJheSA9IFtdO1xuXG5cdFx0YW5ndWxhci5mb3JFYWNoKGJhbmRTdmMudHJhY2tBcnJheSwgZnVuY3Rpb24odHJhY2ssIGtleSkge1xuXHRcdFx0dm0uYmFuZFRyYWNrSWRBcnJheS5wdXNoKHRyYWNrLmlkKTtcblx0XHR9KTtcblxuXHRcdC8vdm0udHJhY2sxLnBsYXkoKTtcblx0XHQvL3NldFRpbWVvdXQoZnVuY3Rpb24oKXtwbGF5QXVkaW9GaWxlKHZtLnRyYWNrMil9LCA0MDApO1xuXHR9XG5cblx0Ly9WbSBmdW5jdGlvbnNcblx0dm0uYWRkVG9CYW5kID0gZnVuY3Rpb24odHJhY2spIHtcblxuXHRcdGJhbmRTdmMudHJhY2tBcnJheS5wdXNoKHRyYWNrKTtcblx0XHRhbmd1bGFyLmZvckVhY2goYmFuZFN2Yy50cmFja0FycmF5LCBmdW5jdGlvbih0cmFjaywga2V5KSB7XG5cdFx0XHR2bS5iYW5kVHJhY2tJZEFycmF5LnB1c2godHJhY2suaWQpO1xuXHRcdH0pO1xuXG5cdFx0Y29uc29sZS5sb2coXCJUcmFjayBhZGRlZCB0byBuZXcgYmFuZDogXCIgKyB0cmFjayk7XG5cdFx0Y29uc29sZS5sb2coYmFuZFN2Yy50cmFja0FycmF5KTtcblx0fVxuXG5cdHZtLnJlbW92ZUZyb21CYW5kID0gZnVuY3Rpb24odHJhY2spIHtcblx0XHRcblx0XHRpbmRleCA9IGFycmF5T2JqZWN0SW5kZXhPZihiYW5kU3ZjLnRyYWNrQXJyYXksIHRyYWNrLmlkLCBcImlkXCIpO1xuXHRcdGlmIChpbmRleCA+IC0xKSB7XG5cdFx0XHRiYW5kU3ZjLnRyYWNrQXJyYXkuc3BsaWNlKGluZGV4LCAxKTtcblx0XHRcdHZtLmJhbmRUcmFja0FycmF5ID0gYmFuZFN2Yy50cmFja0FycmF5O1xuXG5cdFx0XHRpbnRJbmRleCA9IHZtLmJhbmRUcmFja0lkQXJyYXkuaW5kZXhPZih0cmFjay5pZCk7XG5cdFx0XHRpZiAoaW50SW5kZXggPiAtMSkge1xuXHRcdFx0XHR2bS5iYW5kVHJhY2tJZEFycmF5LnNwbGljZShpbnRJbmRleCwgMSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Y29uc29sZS5sb2coXCJUcmFjayByZW1vdmVkIGZyb20gbmV3IGJhbmQ6IFwiICsgdHJhY2spO1xuXHRcdGNvbnNvbGUubG9nKGJhbmRTdmMudHJhY2tBcnJheSk7XG5cdH1cblxuXHQvL1dhdGNoZXNcblx0JHNjb3BlLiR3YXRjaChcblx0XHRmdW5jdGlvbiAoKSB7IHJldHVybiB2bS5maWx0ZXJEYXRhIH0sIFxuXHRcdGZ1bmN0aW9uICgpIHtcblxuXHRcdFx0aWYodm0uZmlsdGVyRGF0YSkgXG5cdFx0XHR7XG5cdFx0XHRcdGZpbHRlcigpO1xuXHRcdFx0fVxuXHRcdH0sIHRydWUpO1xuXG5cblxuXHR2bS50cmFjazEgPSBuZXcgQXVkaW8oXCJkaXN0L2F1ZGlvL0JlaGVtb3RoIC0gQ29ucXVlciBBbGwgLSBEcnVtLm1wM1wiKTtcblx0dm0udHJhY2syID0gbmV3IEF1ZGlvKFwiZGlzdC9hdWRpby9CZWhlbW90aCAtIENvbnF1ZXIgQWxsIC0gR3VpdGFyLm1wM1wiKTtcblxuXG5cdF9pbml0KCk7XG59KTsiLCJhcHAuZmlsdGVyKFwiYmFuZFwiLCBmdW5jdGlvbigpIHtcblx0cmV0dXJuIGZ1bmN0aW9uKHRyYWNrSWQsIGxpc3QpIHtcblx0XHR2YXIgcmV0dXJuVmFsdWUgPSBmYWxzZTtcblx0XHRcblx0XHRhbmd1bGFyLmZvckVhY2gobGlzdCwgZnVuY3Rpb24oaWQsIGluZGV4KSB7XG5cdFx0XHRpZihpZCA9PSB0cmFja0lkKSB7XG5cdFx0XHRcdHJldHVyblZhbHVlID0gdHJ1ZTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHRyZXR1cm4gcmV0dXJuVmFsdWU7XG5cdH1cbn0pOyIsImFwcC5zZXJ2aWNlKFwiYmFuZFNlcnZpY2VcIiwgZnVuY3Rpb24oKSB7XG5cdHZhciBzdmMgPSB0aGlzO1xuXHRzdmMudGVzdFZhbHVlID0gXCJUaGlzIHZhbHVlIGlzIGZyb20gYSBzZXJ2aWNlIVwiO1xuXG5cdHN2Yy50cmFja0FycmF5ID0gW107XG5cblx0XG5cblxuXG5cblx0c3ZjLnRlc3RGdW5jdGlvbiA9IGZ1bmN0aW9uKCkge1xuXHRcdGFsZXJ0KFwiVGVzdCBmdW5jdGlvbiBjYWxsZWQgZnJvbSBpbnNpZGUgc2VydmljZSFcIik7XG5cdH1cbn0pIiwiYXBwLnNlcnZpY2UoXCJmaWx0ZXJTZXJ2aWNlXCIsIGZ1bmN0aW9uKGluc3RydW1lbnRTZXJ2aWNlKSB7XG5cdFxuXHR2YXIgc3ZjID0gdGhpcztcblx0dmFyIGluc3RTdmMgPSBpbnN0cnVtZW50U2VydmljZTtcblxuXG5cdHN2Yy5jcmVhdGVGaWx0ZXJEYXRhID0gZnVuY3Rpb24oKVxuXHR7XG5cdFx0c3ZjLmZpbHRlckRhdGEgPSB7XHRcImFydGlzdFwiOiBcIlwiLFxuXHRcdFx0XHRcdFx0XHRcInRpdGxlXCI6IFwiXCIsXG5cdFx0XHRcdFx0XHRcdH07XG5cblx0XHRhbmd1bGFyLmZvckVhY2goaW5zdFN2Yy5pbnN0cnVtZW50cywgZnVuY3Rpb24odmFsdWUsIGtleSlcblx0XHR7XG5cdFx0XHRzdmMuZmlsdGVyRGF0YVt2YWx1ZS5pZF0gPSB0cnVlO1xuXHRcdH0pO1xuXHR9XG5cblx0ZnVuY3Rpb24gX2luaXQoKSB7XG5cdFx0c3ZjLmNyZWF0ZUZpbHRlckRhdGEoKTtcblx0fVxuXG5cdF9pbml0KCk7XG59KSIsImFwcC5zZXJ2aWNlKFwiaW5zdHJ1bWVudFNlcnZpY2VcIiwgZnVuY3Rpb24oJGh0dHApIHtcblx0XG5cdC8vR2xvYmFsc1xuXHR2YXIgc3ZjID0gdGhpcztcblxuXHQvL1ByaXZhdGUgZnVuY3Rpb25zXG5cdGZ1bmN0aW9uIGdldERhdGEgKHVybCwgb3B0aW9ucykge1xuXG5cdFx0IW9wdGlvbnMgPyBvcHRpb25zID0ge30gOiBcIlwiO1xuXG5cdFx0cmV0dXJuICRodHRwLmdldCh1cmwsIG9wdGlvbnMpXG5cdH1cblxuXHQvL1N2YyBmdW5jdGlvbnNcblx0c3ZjLmdldEluc3RydW1lbnRzID0gZnVuY3Rpb24gKCkge1xuXG5cdFx0dmFyIHVybCA9IENPTlNUQU5UUy5BUElfQkFTRV9VUkwgKyBcIi9pbnN0cnVtZW50c1wiO1xuXHRcdFxuXHRzdmMuaW5zdHJ1bWVudHMgPSBnZXREYXRhKHVybCk7XG5cdH1cblxuXHRzdmMuaW5zdHJ1bWVudHMgPSBbe1xuXHRcdFx0XHRcdFx0XHRcIm5hbWVcIjpcIkxlYWQtZ3VpdGFyXCIsXG5cdFx0XHRcdFx0XHRcdFwiaWRcIjoxXG5cdFx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0XHRcIm5hbWVcIjpcIkRydW1cIixcblx0XHRcdFx0XHRcdFx0XCJpZFwiOjJcblx0XHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdFwibmFtZVwiOlwiQmFzc1wiLFxuXHRcdFx0XHRcdFx0XHRcImlkXCI6M1xuXHRcdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFx0XCJuYW1lXCI6XCJLZXlzXCIsXG5cdFx0XHRcdFx0XHRcdFwiaWRcIjo0XG5cdFx0XHRcdFx0XHR9XTtcbn0pIiwiYXBwLnNlcnZpY2UoXCJzb2xvU2VydmljZVwiLCBmdW5jdGlvbigkaHR0cCkge1xuXHRcblx0Ly9HbG9iYWxzXG5cdHZhciBzdmMgPSB0aGlzO1xuXG5cdC8vUHJpdmF0ZSBmdW5jdGlvbnNcblx0ZnVuY3Rpb24gZ2V0RGF0YSAodXJsLCBvcHRpb25zKSB7XG5cblx0XHQhb3B0aW9ucyA/IG9wdGlvbnMgPSB7fSA6IFwiXCI7XG5cblx0XHRyZXR1cm4gJGh0dHAuZ2V0KHVybCwgb3B0aW9ucylcblx0fVxuXG5cdC8vU3ZjIGZ1bmN0aW9uc1xuXHRzdmMuZ2V0VHJhY2tzID0gZnVuY3Rpb24gKCkge1xuXG5cdFx0dmFyIHVybCA9IENPTlNUQU5UUy5BUElfQkFTRV9VUkwgKyBcIi90cmFja3NcIjtcblx0XHRcblx0XHRyZXR1cm4gZ2V0RGF0YSh1cmwpO1xuXHR9XG5cblx0c3ZjLmdldFRyYWNrQnlJZCA9IGZ1bmN0aW9uIChpZCkge1xuXG5cdFx0dmFyIHVybCA9IENPTlNUQU5UUy5BUElfQkFTRV9VUkwgKyBcIi90cmFja3MvXCIgKyBpZDtcblxuXHRcdHJldHVybiBnZXREYXRhKHVybCk7XG5cdH1cbn0pIiwiYXBwLmRpcmVjdGl2ZShcImRjYkhlYWRlclwiLCBmdW5jdGlvbigpIHtcblx0cmV0dXJuIHtcblx0XHRyZXN0cmljdDogXCJFXCIsXG5cdFx0dGVtcGxhdGVVcmw6IFwiYXBwL2RpcmVjdGl2ZXMvZGNiLWhlYWRlci9kY2ItaGVhZGVyLmh0bWxcIixcblx0XHRyZXBsYWNlOiB0cnVlLFxuXHRcdHNjb3BlOiB7fSxcblx0XHRjb250cm9sbGVyQXM6IFwiaGVhZFwiLFxuXHRcdGNvbnRyb2xsZXI6IGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIHZtID0gdGhpcztcblxuXHRcdFx0ZnVuY3Rpb24gX2luaXQoKSB7XG5cdFx0XHRcdHZtLnZhbHVlID0gXCJUaGlzIGlzIGEgZGlyZWN0aXZlIHRlc3QgdmFsdWUhXCI7XG5cdFx0XHR9XG5cblx0XHRcdF9pbml0KCk7XG5cdFx0fVxuXHR9XG59KSIsImFwcC5kaXJlY3RpdmUoXCJkY2JCYW5kXCIsIGZ1bmN0aW9uKGJhbmRTZXJ2aWNlKSB7XG5cdHJldHVybiB7XG5cdFx0cmVzdHJpY3Q6IFwiRVwiLFxuXHRcdHRlbXBsYXRlVXJsOiBcImFwcC9kaXJlY3RpdmVzL2RjYi1iYW5kL2RjYi1iYW5kLmh0bWxcIixcblx0XHRyZXBsYWNlOiB0cnVlLFxuXHRcdHNjb3BlOiB7fSxcblx0XHRjb250cm9sbGVyQXM6IFwiYmFuZFwiLFxuXHRcdGNvbnRyb2xsZXI6IGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIHZtID0gdGhpcztcblx0XHRcdHZhciBiYW5kU3ZjID0gYmFuZFNlcnZpY2U7XG5cblx0XHRcdGZ1bmN0aW9uIF9pbml0KCkge1xuXHRcdFx0XHR2bS52YWx1ZSA9IFwiTmV3QmFuZFwiO1xuXHRcdFx0fVxuXG5cdFx0XHRfaW5pdCgpO1xuXHRcdH1cblx0fVxufSkiXX0=