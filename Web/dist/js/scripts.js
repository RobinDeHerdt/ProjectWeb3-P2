var app=angular.module("app",["ui.router","satellizer","ngCookies"]),CONSTANTS=function(){var e={};return e.API_BASE_URL="http://discoverbandapi.int/public/api",e}();app.config(["$stateProvider","$urlRouterProvider","$authProvider",function(e,r,t){t.loginUrl=CONSTANTS.API_BASE_URL+"/login",t.signupUrl=CONSTANTS.API_BASE_URL+"/register",r.otherwise("/"),e.state("home",{url:"/",templateUrl:"app/pages/home.html",controller:"homeController as home"}).state("solo",{url:"/solo",templateUrl:"app/pages/solo.html",controller:"soloController as solo"}).state("merged",{url:"/merged",templateUrl:"app/pages/merged.html",controller:"mergedController as merged"}).state("band",{url:"/band",templateUrl:"app/pages/band.html",controller:"bandController as band"}).state("merge",{url:"/merge",templateUrl:"app/pages/merge.html",controller:"mergeController as merge"}).state("profile",{url:"/profile",templateUrl:"app/pages/profile.html",controller:"profileController as profile"})}]),app.controller("bandController",["bandService",function(e){function r(){t.gg=n.testValue}var t=this,n=e;r()}]),app.controller("homeController",["instrumentService","filterService",function(e,r){function t(){n.filterData=o.filterData}var n=this,o=r;t()}]),app.controller("mergeController",function(){function e(){}e()}),app.controller("mergedController",function(){function e(){r.test="Merged"}var r=this;e()}),app.controller("profileController",["userService",function(e){function r(){n.getUser().then(function(e){t.username=e.data.username,t.email=e.data.email})}var t=this,n=e,o=document.getElementById("update-profile-spinner"),a={lines:13,length:28,width:12,radius:42,scale:.15,corners:1,color:"#000",opacity:.25,rotate:0,direction:1,speed:1,trail:60,fps:20,zIndex:2e9,className:"spinner",top:"89%",left:"25.5%",shadow:!1,hwaccel:!1,position:"absolute"};t.update=function(){var e=new Spinner(a).spin(o);t.loading=!0;var r={username:t.username,email:t.email};n.updateUser(r).then(function(r){e.stop(),t.loading=!1},function(r){e.stop(),t.loading=!1})},r()}]),app.controller("soloController",["$scope","bandService","soloService","instrumentService","filterService",function(e,r,t,n,o){function a(){d.getTracks().then(function(e){s.soloTracks=e.data,s.filteredTracks=s.soloTracks,i(),angular.forEach(s.soloTracks,function(e,r){newTrack=new Audio("dist/audio/Behemoth - Conquer All - Drum.mp3"),s.soloTrackAudio[e.id]=newTrack})},function(e){console.log(e)})}function i(){s.filteredTracks=[],angular.forEach(s.soloTracks,function(e,r){goodSearch=!0,""!=!s.filterData.artist||e.artist.name.match(new RegExp(s.filterData.artist,"i"))||(goodSearch=!1),""!=!s.filterData.title||e.songname.match(new RegExp(s.filterData.title,"i"))||(goodSearch=!1),s.filterData[e.instrument_id]||(goodSearch=!1),goodSearch&&s.filteredTracks.push(e)})}function c(e,r,t){for(var n=0,o=e.length;n<o;n++)if(e[n][t]===r)return n;return-1}function l(){s.soloTrackAudio=[],s.currentAudioTrackId="",a(),s.instruments=p.instruments,s.filterData=g.filterData,s.bandTrackIdArray=[],angular.forEach(u.trackArray,function(e,r){s.bandTrackIdArray.push(e.id)})}var s=this,u=r,d=t,p=n,g=o;s.addToBand=function(e){s.bandTrackIdArray=[],u.trackArray.push(e),u.trackArrayCount++,angular.forEach(u.trackArray,function(e,r){s.bandTrackIdArray.push(e.id)}),console.log("Track added to new band: "+e)},s.removeFromBand=function(e){index=c(u.trackArray,e.id,"id"),index>-1&&(u.trackArray.splice(index,1),u.trackArrayCount--,s.bandTrackArray=u.trackArray,intIndex=s.bandTrackIdArray.indexOf(e.id),intIndex>-1&&s.bandTrackIdArray.splice(intIndex,1)),console.log("Track removed from new band: "+e)},s.play=function(e){""!=s.currentAudioTrackId&&s.pause(s.currentAudioTrackId),s.currentAudioTrackId=e,s.soloTrackAudio[e].play()},s.pause=function(e){s.soloTrackAudio[e].pause(),s.currentAudioTrackId=""},e.$watch(function(){return s.filterData},function(){s.filterData&&i()},!0),s.track1=new Audio("dist/audio/Behemoth - Conquer All - Drum.mp3"),s.track2=new Audio("dist/audio/Behemoth - Conquer All - Guitar.mp3"),l()}]),app.filter("band",function(){return function(e,r){var t=!1;return angular.forEach(r,function(r,n){r==e&&(t=!0)}),t}}),app.service("authService",["$auth","$rootScope","$cookies","$state","userService",function(e,r,t,n,o){function a(e,n,o,a){var c=new Date;c=c.setTime(c.getTime()+1e3*e.expires_in),c=new Date(c);var l={token:e,userId:n,username:o,email:a};i.user=l,t.putObject("user",l,{expires:c}),r.isLoggedIn=!0,"1"==l.isAdmin?r.isAdmin=!0:r.isAdmin=!1}var i=this,c=o;i.isLoggedIn=null,i.login=function(r){e.login(r).then(function(e){token=e.data.token,id=0,username="",email="",c.getUser().then(function(e){id=e.data.id,username=e.data.username,email=e.data.email,a(token,id,username,email),i.isLoggedIn=!0},function(e){console.log(e),i.isLoggedIn=!1})},function(e){console.log(e),i.isLoggedIn=!1})},i.logout=function(){e.logout().then(function(e){r.isLoggedIn=!1,r.isAdmin=!1,i.user=null,i.isLoggedIn=null,t.remove("user"),n.go("home")},function(e){console.log(e)})},i.register=function(e){var r=CONSTANTS.API_BASE_URL+"/user";return $http.post(r,e)}}]),app.service("bandService",function(){var e=this;e.testValue="This value is from a service!",e.trackArray=[],e.trackArrayCount=0,e.testFunction=function(){alert("Test function called from inside service!")}}),app.service("filterService",["instrumentService",function(e){function r(){t.createFilterData()}var t=this,n=e;t.createFilterData=function(){t.filterData={artist:"",title:""},angular.forEach(n.instruments,function(e,r){t.filterData[e.id]=!0})},r()}]),app.service("instrumentService",["$http",function(e){function r(r,t){return t?"":t={},e.get(r,t)}var t=this;t.getInstruments=function(){var e=CONSTANTS.API_BASE_URL+"/instruments";t.instruments=r(e)},t.instruments=[{name:"Lead-guitar",id:1},{name:"Drum",id:2},{name:"Bass",id:3},{name:"Keys",id:4}]}]),app.service("soloService",["$http",function(e){function r(r,t){return t?"":t={},e.get(r,t)}var t=this;t.getTracks=function(){var e=CONSTANTS.API_BASE_URL+"/tracks";return r(e)},t.getTrackById=function(e){var t=CONSTANTS.API_BASE_URL+"/tracks/"+e;return r(t)}}]),app.service("userService",["$http",function(e){var r=this;r.getUser=function(){return e.get(CONSTANTS.API_BASE_URL+"/user")},r.updateUser=function(r){return e.post(CONSTANTS.API_BASE_URL+"/user",r)}}]),app.directive("dcbBand",["bandService",function(e){return{restrict:"E",templateUrl:"app/directives/dcb-band/dcb-band.html",replace:!0,scope:{},controllerAs:"band",controller:function(){function e(){r.value="NewBand"}var r=this;e()}}}]),app.directive("dcbHeader",["bandService",function(e){return{restrict:"E",templateUrl:"app/directives/dcb-header/dcb-header.html",replace:!0,scope:{},controllerAs:"head",controller:["$scope","userService","authService","$auth","$rootScope",function(r,t,n,o,a){function i(){c.trackArray=u.trackArray,c.trackArrayCount=u.trackArrayCount,o.isAuthenticated()&&l.getUser().then(function(e){a.username=e.data.username})}var c=this,l=t,s=n,u=e;c.showLogin=function(){$("#login_modal").modal(),$("#login_modal").modal("open")},c.logout=function(){s.logout()},c.showRegister=function(){$("#register_modal").modal(),$("#register_modal").modal("open")},c.isAuthenticated=function(){return o.isAuthenticated()},i(),r.$watch(function(){return s.user},function(){c.user=s.user})}]}}]),app.directive("dcbLogin",function(){return{restrict:"E",templateUrl:"app/directives/dcb-login/dcb-login.html",replace:!0,scope:{},controllerAs:"login",controller:["$auth","$scope","$rootScope","userService","authService","$cookies",function(e,r,t,n,o,a){var i=this,c=o,l=document.getElementById("login-spinner"),s={lines:13,length:28,width:14,radius:42,scale:.4,corners:1,color:"#000",opacity:.25,rotate:0,direction:1,speed:1,trail:60,fps:20,zIndex:2e9,className:"spinner",top:"60%",left:"50%",shadow:!1,hwaccel:!1,position:"absolute"};i.login=function(){var e=new Spinner(s).spin(l);i.loading=!0;var t={email:i.email,password:i.password};c.login(t);var n=r.$watch(function(){return c.isLoggedIn},function(){c.isLoggedIn&&(i.loading=!1,$("#login_modal").modal(),$("#login_modal").modal("close"),e.stop(),n()),c.isLoggedIn===!1&&(e.stop(),i.loading=!1,n())},!0)}}]}}),app.directive("dcbRegister",["userService",function(e){return{restrict:"E",templateUrl:"app/directives/dcb-register/dcb-register.html",replace:!0,scope:{},controllerAs:"register",controller:["$auth","$scope","$rootScope","userService","authService",function(e,r,t,n,o){var a=this,i=o,c=document.getElementById("register-spinner"),l={lines:13,length:28,width:14,radius:42,scale:.4,corners:1,color:"#000",opacity:.25,rotate:0,direction:1,speed:1,trail:60,fps:20,zIndex:2e9,className:"spinner",top:"60%",left:"50%",shadow:!1,hwaccel:!1,position:"absolute"};a.register=function(){var t=new Spinner(l).spin(c);a.loading=!0;var n={username:a.username,email:a.email,password:a.password};e.signup(n).then(function(e){i.login(n);var o=r.$watch(function(){return i.isLoggedIn},function(){i.isLoggedIn&&(a.loading=!1,$("#register_modal").modal(),$("#register_modal").modal("close"),t.stop(),o()),i.isLoggedIn===!1&&(t.stop(),a.loading=!1,o())},!0)})["catch"](function(e){t.stop(),a.loading=!1,console.log(e)})}}]}}]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNvbmZpZy5qcyIsInJvdXRlcy5qcyIsImJhbmRDb250cm9sbGVyLmpzIiwiaG9tZUNvbnRyb2xsZXIuanMiLCJtZXJnZUNvbnRyb2xsZXIuanMiLCJtZXJnZWRDb250cm9sbGVyLmpzIiwicHJvZmlsZUNvbnRyb2xsZXIuanMiLCJzb2xvQ29udHJvbGxlci5qcyIsImJhbmRGaWx0ZXIuanMiLCJhdXRoU2VydmljZS5qcyIsImJhbmRTZXJ2aWNlLmpzIiwiZmlsdGVyU2VydmljZS5qcyIsImluc3RydW1lbnRTZXJ2aWNlLmpzIiwic29sb1NlcnZpY2UuanMiLCJ1c2VyU2VydmljZS5qcyIsImRjYi1iYW5kL2RjYi1iYW5kLmpzIiwiZGNiLWhlYWRlci9kY2ItaGVhZGVyLmpzIiwiZGNiLWxvZ2luL2RjYi1sb2dpbi5qcyIsImRjYi1yZWdpc3Rlci9kY2ItcmVnaXN0ZXIuanMiXSwibmFtZXMiOlsiYXBwIiwiYW5ndWxhciIsIm1vZHVsZSIsIkNPTlNUQU5UUyIsIkFQSV9CQVNFX1VSTCIsImNvbmZpZyIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwiJGF1dGhQcm92aWRlciIsImxvZ2luVXJsIiwic2lnbnVwVXJsIiwib3RoZXJ3aXNlIiwic3RhdGUiLCJ1cmwiLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCJiYW5kU2VydmljZSIsIl9pbml0Iiwidm0iLCJnZyIsImJhbmRTdmMiLCJ0ZXN0VmFsdWUiLCJ0aGlzIiwiaW5zdHJ1bWVudFNlcnZpY2UiLCJmaWx0ZXJTZXJ2aWNlIiwiZmlsdGVyRGF0YSIsImZsdFN2YyIsInRlc3QiLCJ1c2VyU2VydmljZSIsInVzZXJTdmMiLCJnZXRVc2VyIiwidGhlbiIsImRhdGEiLCJ1c2VybmFtZSIsImVtYWlsIiwidGFyZ2V0IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsIm9wdHMiLCJsaW5lcyIsImxlbmd0aCIsIndpZHRoIiwicmFkaXVzIiwic2NhbGUiLCJjb3JuZXJzIiwiY29sb3IiLCJvcGFjaXR5Iiwicm90YXRlIiwiZGlyZWN0aW9uIiwic3BlZWQiLCJ0cmFpbCIsImZwcyIsInpJbmRleCIsImNsYXNzTmFtZSIsInRvcCIsImxlZnQiLCJzaGFkb3ciLCJod2FjY2VsIiwicG9zaXRpb24iLCJ1cGRhdGUiLCJzcGlubmVyIiwiU3Bpbm5lciIsInNwaW4iLCJsb2FkaW5nIiwidXNlcmluZm8iLCJ1cGRhdGVVc2VyIiwic3RvcCIsImVycm9yIiwiJHNjb3BlIiwic29sb1NlcnZpY2UiLCJnZXRTb2xvVHJhY2tzIiwic29sb1N2YyIsImdldFRyYWNrcyIsInNvbG9UcmFja3MiLCJmaWx0ZXJlZFRyYWNrcyIsImZpbHRlciIsImZvckVhY2giLCJ0cmFjayIsImtleSIsIm5ld1RyYWNrIiwiQXVkaW8iLCJzb2xvVHJhY2tBdWRpbyIsImlkIiwiY29uc29sZSIsImxvZyIsImdvb2RTZWFyY2giLCJhcnRpc3QiLCJuYW1lIiwibWF0Y2giLCJSZWdFeHAiLCJ0aXRsZSIsInNvbmduYW1lIiwiaW5zdHJ1bWVudF9pZCIsInB1c2giLCJhcnJheU9iamVjdEluZGV4T2YiLCJteUFycmF5Iiwic2VhcmNoVGVybSIsInByb3BlcnR5IiwiaSIsImxlbiIsImN1cnJlbnRBdWRpb1RyYWNrSWQiLCJpbnN0cnVtZW50cyIsImluc3RTdmMiLCJiYW5kVHJhY2tJZEFycmF5IiwidHJhY2tBcnJheSIsImFkZFRvQmFuZCIsInRyYWNrQXJyYXlDb3VudCIsInJlbW92ZUZyb21CYW5kIiwiaW5kZXgiLCJzcGxpY2UiLCJiYW5kVHJhY2tBcnJheSIsImludEluZGV4IiwiaW5kZXhPZiIsInBsYXkiLCJ0cmFja0lkIiwicGF1c2UiLCIkd2F0Y2giLCJ0cmFjazEiLCJ0cmFjazIiLCJsaXN0IiwicmV0dXJuVmFsdWUiLCJzZXJ2aWNlIiwiJGF1dGgiLCIkcm9vdFNjb3BlIiwiJGNvb2tpZXMiLCIkc3RhdGUiLCJsb2dpbiIsInRva2VuIiwiZXhwaXJhdGlvblRpbWUiLCJEYXRlIiwic2V0VGltZSIsImdldFRpbWUiLCJ1c2VyRGF0YSIsInVzZXJJZCIsInN2YyIsInVzZXIiLCJwdXRPYmplY3QiLCJleHBpcmVzIiwiaXNMb2dnZWRJbiIsImlzQWRtaW4iLCJjcmVkZW50aWFscyIsImxvZ291dCIsInJlbW92ZSIsImdvIiwicmVnaXN0ZXIiLCIkaHR0cCIsInBvc3QiLCJ0ZXN0RnVuY3Rpb24iLCJhbGVydCIsImNyZWF0ZUZpbHRlckRhdGEiLCJ2YWx1ZSIsImdldERhdGEiLCJvcHRpb25zIiwiZ2V0IiwiZ2V0SW5zdHJ1bWVudHMiLCJnZXRUcmFja0J5SWQiLCJkaXJlY3RpdmUiLCJyZXN0cmljdCIsInJlcGxhY2UiLCJzY29wZSIsImNvbnRyb2xsZXJBcyIsImF1dGhTZXJ2aWNlIiwiaXNBdXRoZW50aWNhdGVkIiwiYXV0aFN2YyIsInNob3dMb2dpbiIsIiQiLCJtb2RhbCIsInNob3dSZWdpc3RlciIsInBhc3N3b3JkIiwidW5yZWdpc3RlciIsInNpZ251cCIsInJlc3BvbnNlIl0sIm1hcHBpbmdzIjoiQUFBQSxHQUFJQSxLQUFNQyxRQUFRQyxPQUFPLE9BQ3ZCLFlBQ0EsYUFDQSxjQ0hFQyxVQUFhLFdBRWhCLEdBQUlELEtBSUosT0FGQUEsR0FBT0UsYUFBZSx3Q0FFZkYsSUNOUkYsS0FBSUssUUFBQSxpQkFBQSxxQkFBQSxnQkFBTyxTQUFTQyxFQUFnQkMsRUFBb0JDLEdBQ3REQSxFQUFjQyxTQUFjTixVQUFVQyxhQUFlLFNBQ3JESSxFQUFjRSxVQUFjUCxVQUFVQyxhQUFlLFlBQ3JERyxFQUFtQkksVUFBVSxLQUU3QkwsRUFDR00sTUFBTSxRQUNMQyxJQUFLLElBQ0xDLFlBQWEsc0JBQ2JDLFdBQVksMkJBRWRILE1BQU0sUUFDSkMsSUFBSyxRQUNMQyxZQUFhLHNCQUNiQyxXQUFZLDJCQUViSCxNQUFNLFVBQ0xDLElBQUssVUFDTEMsWUFBYSx3QkFDYkMsV0FBWSwrQkFFYkgsTUFBTSxRQUNMQyxJQUFLLFFBQ0xDLFlBQWEsc0JBQ2JDLFdBQVksMkJBRWJILE1BQU0sU0FDTEMsSUFBSyxT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bGUoXCJhcHBcIiwgW1xyXG5cdFx0XCJ1aS5yb3V0ZXJcIixcclxuXHRcdFwic2F0ZWxsaXplclwiLFxyXG5cdFx0XCJuZ0Nvb2tpZXNcIlxyXG5cdF0pOyIsInZhciBDT05TVEFOVFMgPSAoZnVuY3Rpb24gKCkge1xuXHRcblx0dmFyIG1vZHVsZSA9IHt9O1xuXG5cdG1vZHVsZS5BUElfQkFTRV9VUkwgPSBcImh0dHA6Ly9kaXNjb3ZlcmJhbmRhcGkuaW50L3B1YmxpYy9hcGlcIjtcblxuXHRyZXR1cm4gbW9kdWxlO1xufSgpKTsiLCJhcHAuY29uZmlnKGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIsICRhdXRoUHJvdmlkZXIpIHtcclxuICAkYXV0aFByb3ZpZGVyLmxvZ2luVXJsICAgID0gQ09OU1RBTlRTLkFQSV9CQVNFX1VSTCArICcvbG9naW4nO1xyXG4gICRhdXRoUHJvdmlkZXIuc2lnbnVwVXJsICAgPSBDT05TVEFOVFMuQVBJX0JBU0VfVVJMICsgJy9yZWdpc3Rlcic7XHJcbiAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZShcIi9cIik7XHJcblxyXG4gICRzdGF0ZVByb3ZpZGVyXHJcbiAgICAuc3RhdGUoJ2hvbWUnLCB7XHJcbiAgICAgIHVybDogXCIvXCIsXHJcbiAgICAgIHRlbXBsYXRlVXJsOiBcImFwcC9wYWdlcy9ob21lLmh0bWxcIixcclxuICAgICAgY29udHJvbGxlcjogXCJob21lQ29udHJvbGxlciBhcyBob21lXCJcclxuICAgIH0pXHJcbiAgXHQuc3RhdGUoJ3NvbG8nLCB7XHJcbiAgICAgIHVybDogXCIvc29sb1wiLFxyXG4gICAgICB0ZW1wbGF0ZVVybDogXCJhcHAvcGFnZXMvc29sby5odG1sXCIsXHJcbiAgICAgIGNvbnRyb2xsZXI6IFwic29sb0NvbnRyb2xsZXIgYXMgc29sb1wiXHJcbiAgICB9KVxyXG4gICAgLnN0YXRlKCdtZXJnZWQnLCB7XHJcbiAgICAgIHVybDogXCIvbWVyZ2VkXCIsXHJcbiAgICAgIHRlbXBsYXRlVXJsOiBcImFwcC9wYWdlcy9tZXJnZWQuaHRtbFwiLFxyXG4gICAgICBjb250cm9sbGVyOiBcIm1lcmdlZENvbnRyb2xsZXIgYXMgbWVyZ2VkXCJcclxuICAgIH0pXHJcbiAgICAuc3RhdGUoJ2JhbmQnLCB7XHJcbiAgICAgIHVybDogXCIvYmFuZFwiLFxyXG4gICAgICB0ZW1wbGF0ZVVybDogXCJhcHAvcGFnZXMvYmFuZC5odG1sXCIsXHJcbiAgICAgIGNvbnRyb2xsZXI6IFwiYmFuZENvbnRyb2xsZXIgYXMgYmFuZFwiXHJcbiAgICB9KVxyXG4gICAgLnN0YXRlKCdtZXJnZScsIHtcclxuICAgICAgdXJsOiBcIi9tZXJnZVwiLFxyXG4gICAgICB0ZW1wbGF0ZVVybDogXCJhcHAvcGFnZXMvbWVyZ2UuaHRtbFwiLFxyXG4gICAgICBjb250cm9sbGVyOiBcIm1lcmdlQ29udHJvbGxlciBhcyBtZXJnZVwiXHJcbiAgICB9KVxyXG4gICAgLnN0YXRlKCdwcm9maWxlJywge1xyXG4gICAgICB1cmw6IFwiL3Byb2ZpbGVcIixcclxuICAgICAgdGVtcGxhdGVVcmw6IFwiYXBwL3BhZ2VzL3Byb2ZpbGUuaHRtbFwiLFxyXG4gICAgICBjb250cm9sbGVyOiBcInByb2ZpbGVDb250cm9sbGVyIGFzIHByb2ZpbGVcIlxyXG4gICAgfSlcclxufSk7IiwiYXBwLmNvbnRyb2xsZXIoXCJiYW5kQ29udHJvbGxlclwiLCBmdW5jdGlvbihiYW5kU2VydmljZSkge1xyXG5cdFxyXG5cdHZhciB2bSA9IHRoaXM7XHJcblx0dmFyIGJhbmRTdmMgPSBiYW5kU2VydmljZTtcclxuXHJcblx0ZnVuY3Rpb24gX2luaXQoKSB7XHJcblx0XHR2bS5nZyA9IGJhbmRTdmMudGVzdFZhbHVlO1xyXG5cdH1cclxuXHJcblx0X2luaXQoKTtcclxufSk7IiwiYXBwLmNvbnRyb2xsZXIoXCJob21lQ29udHJvbGxlclwiLCBmdW5jdGlvbihpbnN0cnVtZW50U2VydmljZSwgZmlsdGVyU2VydmljZSkge1xuXHRcblx0dmFyIHZtID0gdGhpcztcblx0dmFyIGluc3RTdmMgPSBpbnN0cnVtZW50U2VydmljZTtcblx0dmFyIGZsdFN2YyA9IGZpbHRlclNlcnZpY2U7XG5cblx0ZnVuY3Rpb24gX2luaXQoKSB7XG5cdFx0Ly9pbnN0U3ZjLmdldEluc3RydW1lbnRzKCk7XG5cblx0XHR2bS5maWx0ZXJEYXRhID0gZmx0U3ZjLmZpbHRlckRhdGE7XG5cdH1cblxuXHRfaW5pdCgpO1xufSk7IiwiYXBwLmNvbnRyb2xsZXIoXCJtZXJnZUNvbnRyb2xsZXJcIiwgZnVuY3Rpb24oKSB7XG5cdHZhciB2bSA9IHRoaXM7XG5cblx0ZnVuY3Rpb24gX2luaXQoKSB7XG5cdFx0XG5cdH1cblxuXHRfaW5pdCgpO1xufSk7IiwiYXBwLmNvbnRyb2xsZXIoXCJtZXJnZWRDb250cm9sbGVyXCIsIGZ1bmN0aW9uKCkge1xuXHR2YXIgdm0gPSB0aGlzO1xuXG5cdGZ1bmN0aW9uIF9pbml0KCkge1xuXHRcdHZtLnRlc3QgPSBcIk1lcmdlZFwiO1xuXHR9XG5cblx0X2luaXQoKTtcbn0pOyIsImFwcC5jb250cm9sbGVyKFwicHJvZmlsZUNvbnRyb2xsZXJcIiwgZnVuY3Rpb24odXNlclNlcnZpY2UpIHtcclxuXHRcclxuXHR2YXIgdm0gXHRcdD0gdGhpcztcclxuXHR2YXIgdXNlclN2YyA9IHVzZXJTZXJ2aWNlO1xyXG5cdHZhciB0YXJnZXQgXHQ9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1cGRhdGUtcHJvZmlsZS1zcGlubmVyJyk7XHJcblxyXG5cdHZhciBvcHRzID0ge1xyXG5cdFx0XHRsaW5lczogMTMgLy8gVGhlIG51bWJlciBvZiBsaW5lcyB0byBkcmF3XHJcblx0XHQsIGxlbmd0aDogMjggLy8gVGhlIGxlbmd0aCBvZiBlYWNoIGxpbmVcclxuXHRcdCwgd2lkdGg6IDEyIC8vIFRoZSBsaW5lIHRoaWNrbmVzc1xyXG5cdFx0LCByYWRpdXM6IDQyIC8vIFRoZSByYWRpdXMgb2YgdGhlIGlubmVyIGNpcmNsZVxyXG5cdFx0LCBzY2FsZTogMC4xNSAvLyBTY2FsZXMgb3ZlcmFsbCBzaXplIG9mIHRoZSBzcGlubmVyXHJcblx0XHQsIGNvcm5lcnM6IDEgLy8gQ29ybmVyIHJvdW5kbmVzcyAoMC4uMSlcclxuXHRcdCwgY29sb3I6ICcjMDAwJyAvLyAjcmdiIG9yICNycmdnYmIgb3IgYXJyYXkgb2YgY29sb3JzXHJcblx0XHQsIG9wYWNpdHk6IDAuMjUgLy8gT3BhY2l0eSBvZiB0aGUgbGluZXNcclxuXHRcdCwgcm90YXRlOiAwIC8vIFRoZSByb3RhdGlvbiBvZmZzZXRcclxuXHRcdCwgZGlyZWN0aW9uOiAxIC8vIDE6IGNsb2Nrd2lzZSwgLTE6IGNvdW50ZXJjbG9ja3dpc2VcclxuXHRcdCwgc3BlZWQ6IDEgLy8gUm91bmRzIHBlciBzZWNvbmRcclxuXHRcdCwgdHJhaWw6IDYwIC8vIEFmdGVyZ2xvdyBwZXJjZW50YWdlXHJcblx0XHQsIGZwczogMjAgLy8gRnJhbWVzIHBlciBzZWNvbmQgd2hlbiB1c2luZyBzZXRUaW1lb3V0KCkgYXMgYSBmYWxsYmFjayBmb3IgQ1NTXHJcblx0XHQsIHpJbmRleDogMmU5IC8vIFRoZSB6LWluZGV4IChkZWZhdWx0cyB0byAyMDAwMDAwMDAwKVxyXG5cdFx0LCBjbGFzc05hbWU6ICdzcGlubmVyJyAvLyBUaGUgQ1NTIGNsYXNzIHRvIGFzc2lnbiB0byB0aGUgc3Bpbm5lclxyXG5cdFx0LCB0b3A6ICc4OSUnIC8vIFRvcCBwb3NpdGlvbiByZWxhdGl2ZSB0byBwYXJlbnRcclxuXHRcdCwgbGVmdDogJzI1LjUlJyAvLyBMZWZ0IHBvc2l0aW9uIHJlbGF0aXZlIHRvIHBhcmVudFxyXG5cdFx0LCBzaGFkb3c6IGZhbHNlIC8vIFdoZXRoZXIgdG8gcmVuZGVyIGEgc2hhZG93XHJcblx0XHQsIGh3YWNjZWw6IGZhbHNlIC8vIFdoZXRoZXIgdG8gdXNlIGhhcmR3YXJlIGFjY2VsZXJhdGlvblxyXG5cdFx0LCBwb3NpdGlvbjogJ2Fic29sdXRlJyAvLyBFbGVtZW50IHBvc2l0aW9uaW5nXHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBfaW5pdCgpIHtcclxuXHRcdHVzZXJTdmMuZ2V0VXNlcigpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuXHRcdFx0dm0udXNlcm5hbWUgPSBkYXRhLmRhdGEudXNlcm5hbWU7XHJcblx0XHRcdHZtLmVtYWlsIFx0PSBkYXRhLmRhdGEuZW1haWw7XHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG5cdHZtLnVwZGF0ZSA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyIHNwaW5uZXIgPSBuZXcgU3Bpbm5lcihvcHRzKS5zcGluKHRhcmdldCk7XHJcblx0ICAgIHZtLmxvYWRpbmcgXHQ9IHRydWU7XHJcblxyXG5cdFx0dmFyIHVzZXJpbmZvID0ge1xyXG4gICAgICAgICAgICB1c2VybmFtZTogdm0udXNlcm5hbWUsXHJcbiAgICAgICAgICAgIGVtYWlsOiB2bS5lbWFpbFxyXG4gICAgICAgIH1cclxuXHJcblx0XHR1c2VyU3ZjLnVwZGF0ZVVzZXIodXNlcmluZm8pXHJcblx0XHRcdC50aGVuKGZ1bmN0aW9uKGRhdGEpXHJcblx0XHRcdHtcclxuXHRcdFx0XHRzcGlubmVyLnN0b3AoKTtcclxuXHRcdFx0XHR2bS5sb2FkaW5nID0gZmFsc2U7XHJcblx0XHRcdH0sIGZ1bmN0aW9uKGVycm9yKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0c3Bpbm5lci5zdG9wKCk7XHJcblx0XHRcdFx0dm0ubG9hZGluZyA9IGZhbHNlO1xyXG5cdFx0XHR9KTtcclxuXHR9XHJcblxyXG5cdF9pbml0KCk7XHJcbn0pOyIsImFwcC5jb250cm9sbGVyKFwic29sb0NvbnRyb2xsZXJcIiwgZnVuY3Rpb24oJHNjb3BlLCBiYW5kU2VydmljZSwgc29sb1NlcnZpY2UsIGluc3RydW1lbnRTZXJ2aWNlLCBmaWx0ZXJTZXJ2aWNlKSB7XG5cdFxuXHR2YXIgdm0gPSB0aGlzO1xuXHR2YXIgYmFuZFN2YyA9IGJhbmRTZXJ2aWNlO1xuXHR2YXIgc29sb1N2YyA9IHNvbG9TZXJ2aWNlO1xuXHR2YXIgaW5zdFN2YyA9IGluc3RydW1lbnRTZXJ2aWNlO1xuXHR2YXIgZmx0U3ZjID0gZmlsdGVyU2VydmljZTtcblxuXHQvL1ByaXZhdGUgZnVuY3Rpb25zXG5cdGZ1bmN0aW9uIHBsYXlBdWRpb0ZpbGUodHJhY2spXG5cdHtcblx0XHR0cmFjay5wbGF5KCk7XG5cdH1cblxuXHRmdW5jdGlvbiBnZXRTb2xvVHJhY2tzKClcblx0e1xuXHRcdHNvbG9TdmMuZ2V0VHJhY2tzKClcblx0XHRcdC50aGVuKGZ1bmN0aW9uKGRhdGEpXG5cdFx0XHR7XG5cdFx0XHRcdHZtLnNvbG9UcmFja3MgPSBkYXRhLmRhdGE7XG5cdFx0XHRcdHZtLmZpbHRlcmVkVHJhY2tzID0gdm0uc29sb1RyYWNrcztcblx0XHRcdFx0ZmlsdGVyKCk7XG5cblx0XHRcdFx0YW5ndWxhci5mb3JFYWNoKHZtLnNvbG9UcmFja3MsIGZ1bmN0aW9uKHRyYWNrLCBrZXkpIHtcblx0XHRcdFx0XHRcdC8vbmV3VHJhY2sgPSBuZXcgQXVkaW8odHJhY2suZmlsZV91cmwpO1xuXHRcdFx0XHRcdFx0bmV3VHJhY2sgPSBuZXcgQXVkaW8oXCJkaXN0L2F1ZGlvL0JlaGVtb3RoIC0gQ29ucXVlciBBbGwgLSBEcnVtLm1wM1wiKTtcblx0XHRcdFx0XHRcdHZtLnNvbG9UcmFja0F1ZGlvW3RyYWNrLmlkXSA9IG5ld1RyYWNrO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHR9LCBmdW5jdGlvbihlcnJvcilcblx0XHRcdHtcblx0XHRcdFx0Y29uc29sZS5sb2coZXJyb3IpO1xuXHRcdFx0fSk7XG5cdH1cblxuXHRmdW5jdGlvbiBmaWx0ZXIoKVxuXHR7XG5cdFx0dm0uZmlsdGVyZWRUcmFja3MgPSBbXTtcblxuXHRcdGFuZ3VsYXIuZm9yRWFjaCh2bS5zb2xvVHJhY2tzLCBmdW5jdGlvbih0cmFjaywga2V5KVxuXHRcdHtcblx0XHRcdC8vY29uc29sZS5sb2codHJhY2spO1xuXHRcdFx0Z29vZFNlYXJjaCA9IHRydWU7XG5cblx0XHRcdGlmKCF2bS5maWx0ZXJEYXRhLmFydGlzdCA9PSBcIlwiICYmICF0cmFjay5hcnRpc3QubmFtZS5tYXRjaChuZXcgUmVnRXhwKHZtLmZpbHRlckRhdGEuYXJ0aXN0LCBcImlcIikpKVxuXHRcdFx0e1xuXHRcdFx0XHRnb29kU2VhcmNoID0gZmFsc2U7XG5cdFx0XHR9XG5cblx0XHRcdGlmKCF2bS5maWx0ZXJEYXRhLnRpdGxlID09IFwiXCIgJiYgIXRyYWNrLnNvbmduYW1lLm1hdGNoKG5ldyBSZWdFeHAodm0uZmlsdGVyRGF0YS50aXRsZSwgXCJpXCIpKSlcblx0XHRcdHtcblx0XHRcdFx0Z29vZFNlYXJjaCA9IGZhbHNlO1xuXHRcdFx0fVxuXG5cdFx0XHRpZighdm0uZmlsdGVyRGF0YVt0cmFjay5pbnN0cnVtZW50X2lkXSlcblx0XHRcdHtcblx0XHRcdFx0Z29vZFNlYXJjaCA9IGZhbHNlO1xuXHRcdFx0fVxuXG5cblx0XHRcdGlmKGdvb2RTZWFyY2gpXG5cdFx0XHR7XG5cdFx0XHRcdHZtLmZpbHRlcmVkVHJhY2tzLnB1c2godHJhY2spO1xuXHRcdFx0fVxuXHRcdFx0Ly9jb25zb2xlLmxvZyh2bS5maWx0ZXJlZFRyYWNrcyk7XG5cdFx0fSk7XG5cdH1cblxuXHRmdW5jdGlvbiBhcnJheU9iamVjdEluZGV4T2YobXlBcnJheSwgc2VhcmNoVGVybSwgcHJvcGVydHkpIHtcbiAgICBcdFxuICAgIFx0Zm9yKHZhciBpID0gMCwgbGVuID0gbXlBcnJheS5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBcdGlmIChteUFycmF5W2ldW3Byb3BlcnR5XSA9PT0gc2VhcmNoVGVybSkgcmV0dXJuIGk7XG4gICAgXHR9XG5cbiAgICBcdHJldHVybiAtMTtcblx0fVxuXG5cdGZ1bmN0aW9uIF9pbml0KCkge1xuXHRcdHZtLnNvbG9UcmFja0F1ZGlvID0gW107XG5cdFx0dm0uY3VycmVudEF1ZGlvVHJhY2tJZCA9IFwiXCI7XG5cblx0XHRnZXRTb2xvVHJhY2tzKCk7XG5cdFx0dm0uaW5zdHJ1bWVudHMgPSBpbnN0U3ZjLmluc3RydW1lbnRzO1xuXHRcdHZtLmZpbHRlckRhdGEgPSBmbHRTdmMuZmlsdGVyRGF0YTtcblx0XHR2bS5iYW5kVHJhY2tJZEFycmF5ID0gW107XG5cblx0XHRhbmd1bGFyLmZvckVhY2goYmFuZFN2Yy50cmFja0FycmF5LCBmdW5jdGlvbih0cmFjaywga2V5KSB7XG5cdFx0XHR2bS5iYW5kVHJhY2tJZEFycmF5LnB1c2godHJhY2suaWQpO1xuXHRcdH0pO1xuXG5cdFx0Ly92bS50cmFjazEucGxheSgpO1xuXHRcdC8vc2V0VGltZW91dChmdW5jdGlvbigpe3BsYXlBdWRpb0ZpbGUodm0udHJhY2syKX0sIDQwMCk7XG5cdH1cblxuXHQvL1ZtIGZ1bmN0aW9uc1xuXHR2bS5hZGRUb0JhbmQgPSBmdW5jdGlvbih0cmFjaykge1xuXG5cdFx0dm0uYmFuZFRyYWNrSWRBcnJheSA9IFtdO1xuXG5cdFx0YmFuZFN2Yy50cmFja0FycmF5LnB1c2godHJhY2spO1xuXHRcdGJhbmRTdmMudHJhY2tBcnJheUNvdW50ICsrO1xuXHRcdGFuZ3VsYXIuZm9yRWFjaChiYW5kU3ZjLnRyYWNrQXJyYXksIGZ1bmN0aW9uKHRyYWNrLCBrZXkpIHtcblx0XHRcdHZtLmJhbmRUcmFja0lkQXJyYXkucHVzaCh0cmFjay5pZCk7XG5cdFx0fSk7XG5cblx0XHRjb25zb2xlLmxvZyhcIlRyYWNrIGFkZGVkIHRvIG5ldyBiYW5kOiBcIiArIHRyYWNrKTtcblx0XHQvL2NvbnNvbGUubG9nKGJhbmRTdmMudHJhY2tBcnJheSk7XG5cdFx0Ly9jb25zb2xlLmxvZyh2bS5iYW5kVHJhY2tJZEFycmF5KTtcblx0fVxuXG5cdHZtLnJlbW92ZUZyb21CYW5kID0gZnVuY3Rpb24odHJhY2spIHtcblx0XHRcblx0XHRpbmRleCA9IGFycmF5T2JqZWN0SW5kZXhPZihiYW5kU3ZjLnRyYWNrQXJyYXksIHRyYWNrLmlkLCBcImlkXCIpO1xuXHRcdGlmIChpbmRleCA+IC0xKSB7XG5cdFx0XHRiYW5kU3ZjLnRyYWNrQXJyYXkuc3BsaWNlKGluZGV4LCAxKTtcblx0XHRcdGJhbmRTdmMudHJhY2tBcnJheUNvdW50IC0tO1xuXHRcdFx0dm0uYmFuZFRyYWNrQXJyYXkgPSBiYW5kU3ZjLnRyYWNrQXJyYXk7XG5cblx0XHRcdGludEluZGV4ID0gdm0uYmFuZFRyYWNrSWRBcnJheS5pbmRleE9mKHRyYWNrLmlkKTtcblx0XHRcdGlmIChpbnRJbmRleCA+IC0xKSB7XG5cdFx0XHRcdHZtLmJhbmRUcmFja0lkQXJyYXkuc3BsaWNlKGludEluZGV4LCAxKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRjb25zb2xlLmxvZyhcIlRyYWNrIHJlbW92ZWQgZnJvbSBuZXcgYmFuZDogXCIgKyB0cmFjayk7XG5cdFx0Ly9jb25zb2xlLmxvZyhiYW5kU3ZjLnRyYWNrQXJyYXkpO1xuXHR9XG5cblx0dm0ucGxheSA9IGZ1bmN0aW9uKHRyYWNrSWQpIHtcblxuXHRcdGlmKHZtLmN1cnJlbnRBdWRpb1RyYWNrSWQgIT0gXCJcIikge1xuXHRcdFx0dm0ucGF1c2Uodm0uY3VycmVudEF1ZGlvVHJhY2tJZCk7XG5cdFx0fVxuXG5cdFx0dm0uY3VycmVudEF1ZGlvVHJhY2tJZCA9IHRyYWNrSWQ7XG5cdFx0dm0uc29sb1RyYWNrQXVkaW9bdHJhY2tJZF0ucGxheSgpO1xuXHR9XG5cblx0dm0ucGF1c2UgPSBmdW5jdGlvbih0cmFja0lkKSB7XG5cdFx0dm0uc29sb1RyYWNrQXVkaW9bdHJhY2tJZF0ucGF1c2UoKTtcblx0XHR2bS5jdXJyZW50QXVkaW9UcmFja0lkID0gXCJcIjtcblx0fVxuXG5cdC8vV2F0Y2hlc1xuXHQkc2NvcGUuJHdhdGNoKFxuXHRcdGZ1bmN0aW9uICgpIHsgcmV0dXJuIHZtLmZpbHRlckRhdGEgfSwgXG5cdFx0ZnVuY3Rpb24gKCkge1xuXG5cdFx0XHRpZih2bS5maWx0ZXJEYXRhKSBcblx0XHRcdHtcblx0XHRcdFx0ZmlsdGVyKCk7XG5cdFx0XHR9XG5cdFx0fSwgdHJ1ZSk7XG5cblxuXG5cdHZtLnRyYWNrMSA9IG5ldyBBdWRpbyhcImRpc3QvYXVkaW8vQmVoZW1vdGggLSBDb25xdWVyIEFsbCAtIERydW0ubXAzXCIpO1xuXHR2bS50cmFjazIgPSBuZXcgQXVkaW8oXCJkaXN0L2F1ZGlvL0JlaGVtb3RoIC0gQ29ucXVlciBBbGwgLSBHdWl0YXIubXAzXCIpO1xuXG5cblx0X2luaXQoKTtcbn0pOyIsImFwcC5maWx0ZXIoXCJiYW5kXCIsIGZ1bmN0aW9uKCkge1xuXHRyZXR1cm4gZnVuY3Rpb24odHJhY2tJZCwgbGlzdCkge1xuXHRcdHZhciByZXR1cm5WYWx1ZSA9IGZhbHNlO1xuXHRcdFxuXHRcdGFuZ3VsYXIuZm9yRWFjaChsaXN0LCBmdW5jdGlvbihpZCwgaW5kZXgpIHtcblx0XHRcdGlmKGlkID09IHRyYWNrSWQpIHtcblx0XHRcdFx0cmV0dXJuVmFsdWUgPSB0cnVlO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdHJldHVybiByZXR1cm5WYWx1ZTtcblx0fVxufSk7IiwiYXBwLnNlcnZpY2UoXCJhdXRoU2VydmljZVwiLCBmdW5jdGlvbiAoJGF1dGgsICRyb290U2NvcGUsICRjb29raWVzLCAkc3RhdGUsIHVzZXJTZXJ2aWNlKSB7XHJcblx0XHJcblx0dmFyIHN2YyBcdFx0PSB0aGlzO1xyXG5cdHZhciB1c2VyU3ZjIFx0PSB1c2VyU2VydmljZTtcclxuXHJcblx0c3ZjLmlzTG9nZ2VkSW4gXHQ9IG51bGw7XHJcblxyXG5cdC8vUHJpdmF0ZSBmdW5jdGlvbnNcclxuXHRmdW5jdGlvbiBsb2dpbiAodG9rZW4sIGlkLCB1c2VybmFtZSwgZW1haWwpIHtcclxuXHJcblx0XHR2YXIgZXhwaXJhdGlvblRpbWUgPSBuZXcgRGF0ZSgpO1xyXG5cdFx0ZXhwaXJhdGlvblRpbWUgPSBleHBpcmF0aW9uVGltZS5zZXRUaW1lKGV4cGlyYXRpb25UaW1lLmdldFRpbWUoKSArICh0b2tlbltcImV4cGlyZXNfaW5cIl0gKiAxMDAwKSk7XHJcblx0XHRleHBpcmF0aW9uVGltZSA9IG5ldyBEYXRlKGV4cGlyYXRpb25UaW1lKTtcclxuXHJcblx0XHR2YXIgdXNlckRhdGEgPSB7XHJcblxyXG5cdFx0XHR0b2tlbjogdG9rZW4sXHJcblx0XHRcdHVzZXJJZDogaWQsXHJcblx0XHRcdHVzZXJuYW1lOiB1c2VybmFtZSxcclxuXHRcdFx0ZW1haWw6IGVtYWlsLFxyXG5cdFx0XHQvL2lzQWRtaW46IGRhdGEuZGF0YS5pc0FkbWluXHJcblx0XHR9XHJcblxyXG5cdFx0Ly9jb25zb2xlLmxvZyh1c2VyRGF0YS50b2tlbik7XHJcblxyXG5cdFx0c3ZjLnVzZXIgPSB1c2VyRGF0YTtcclxuXHJcblx0XHQkY29va2llcy5wdXRPYmplY3QoXCJ1c2VyXCIsIHVzZXJEYXRhLCB7IGV4cGlyZXM6IGV4cGlyYXRpb25UaW1lIH0pO1xyXG5cdFx0JHJvb3RTY29wZS5pc0xvZ2dlZEluID0gdHJ1ZTtcclxuXHRcdFxyXG5cdFx0Ly9DaGVjayBpZiByZXR1cm5lZCB1c2VyIGlzIEFkbWluXHJcblx0XHR1c2VyRGF0YS5pc0FkbWluID09IFwiMVwiID8gJHJvb3RTY29wZS5pc0FkbWluID0gdHJ1ZSA6ICRyb290U2NvcGUuaXNBZG1pbiA9IGZhbHNlO1xyXG5cdH1cclxuXHJcblx0Ly9TdmMgZnVuY3Rpb25zXHJcblx0c3ZjLmxvZ2luID0gZnVuY3Rpb24gKGNyZWRlbnRpYWxzKSB7XHJcblxyXG5cdFx0JGF1dGgubG9naW4oY3JlZGVudGlhbHMpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgIFx0Ly8gQXV0aGVudGljYXRpb24gc3VjY2Vzc1xyXG4gICAgICAgIFx0dG9rZW4gXHRcdD0gZGF0YS5kYXRhLnRva2VuO1xyXG4gICAgICAgIFx0aWQgXHRcdFx0PSAwO1xyXG4gICAgICAgIFx0dXNlcm5hbWUgXHQ9IFwiXCI7XHJcbiAgICAgICAgXHRlbWFpbCBcdFx0PSBcIlwiO1xyXG5cclxuXHRcdFx0dXNlclN2Yy5nZXRVc2VyKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG5cdFx0XHRcdGlkIFx0XHRcdD0gZGF0YS5kYXRhLmlkO1xyXG5cdFx0XHRcdHVzZXJuYW1lIFx0PSBkYXRhLmRhdGEudXNlcm5hbWU7XHJcblx0XHRcdFx0ZW1haWwgXHRcdD0gZGF0YS5kYXRhLmVtYWlsO1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdGxvZ2luKHRva2VuLCBpZCwgdXNlcm5hbWUsIGVtYWlsKTtcclxuXHRcdFx0XHRzdmMuaXNMb2dnZWRJbiA9IHRydWU7XHJcblx0XHRcdH0sIGZ1bmN0aW9uKGVycm9yKSB7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coZXJyb3IpO1xyXG5cdFx0XHRcdHN2Yy5pc0xvZ2dlZEluID0gZmFsc2U7XHJcblx0XHRcdH0pO1xyXG4gICAgICAgIH0sIFxyXG4gICAgICAgIGZ1bmN0aW9uKGVycm9yKXtcclxuICAgICAgICBcdC8vIEF1dGhlbnRpY2F0aW9uIGZhaWxlZFxyXG4gICAgICAgIFx0Y29uc29sZS5sb2coZXJyb3IpO1xyXG4gICAgICAgIFx0c3ZjLmlzTG9nZ2VkSW4gPSBmYWxzZTsgXHJcbiAgICAgICAgfSk7XHJcblx0fVxyXG5cclxuXHRzdmMubG9nb3V0ID0gZnVuY3Rpb24gKCkge1xyXG5cclxuXHRcdCRhdXRoLmxvZ291dCgpXHJcblx0XHRcdC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcblxyXG5cdFx0XHRcdCRyb290U2NvcGUuaXNMb2dnZWRJbiA9IGZhbHNlO1xyXG5cdFx0XHRcdCRyb290U2NvcGUuaXNBZG1pbiA9IGZhbHNlO1xyXG5cdFx0XHRcdHN2Yy51c2VyID0gbnVsbDtcclxuXHRcdFx0XHRzdmMuaXNMb2dnZWRJbiA9IG51bGw7XHJcblxyXG5cdFx0XHRcdCRjb29raWVzLnJlbW92ZShcInVzZXJcIik7XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0JHN0YXRlLmdvKFwiaG9tZVwiKTtcclxuXHRcdFx0fSwgZnVuY3Rpb24gKGVycm9yKSB7XHJcblxyXG5cdFx0XHRcdGNvbnNvbGUubG9nKGVycm9yKTtcclxuXHRcdFx0fSlcclxuXHR9XHJcblxyXG5cdHN2Yy5yZWdpc3RlciA9IGZ1bmN0aW9uICh1c2VyKSB7XHJcblxyXG5cdFx0dmFyIHVybCA9IENPTlNUQU5UUy5BUElfQkFTRV9VUkwgKyBcIi91c2VyXCI7XHJcblxyXG5cdFx0cmV0dXJuICRodHRwLnBvc3QodXJsLCB1c2VyKTtcclxuXHR9XHJcbn0pOyIsImFwcC5zZXJ2aWNlKFwiYmFuZFNlcnZpY2VcIiwgZnVuY3Rpb24oKSB7XHJcblx0dmFyIHN2YyA9IHRoaXM7XHJcblx0c3ZjLnRlc3RWYWx1ZSA9IFwiVGhpcyB2YWx1ZSBpcyBmcm9tIGEgc2VydmljZSFcIjtcclxuXHJcblx0c3ZjLnRyYWNrQXJyYXkgPSBbXTtcclxuXHRzdmMudHJhY2tBcnJheUNvdW50ID0gMDtcclxuXHJcblx0XHJcblxyXG5cclxuXHJcblxyXG5cdHN2Yy50ZXN0RnVuY3Rpb24gPSBmdW5jdGlvbigpIHtcclxuXHRcdGFsZXJ0KFwiVGVzdCBmdW5jdGlvbiBjYWxsZWQgZnJvbSBpbnNpZGUgc2VydmljZSFcIik7XHJcblx0fVxyXG59KSIsImFwcC5zZXJ2aWNlKFwiZmlsdGVyU2VydmljZVwiLCBmdW5jdGlvbihpbnN0cnVtZW50U2VydmljZSkge1xuXHRcblx0dmFyIHN2YyA9IHRoaXM7XG5cdHZhciBpbnN0U3ZjID0gaW5zdHJ1bWVudFNlcnZpY2U7XG5cblxuXHRzdmMuY3JlYXRlRmlsdGVyRGF0YSA9IGZ1bmN0aW9uKClcblx0e1xuXHRcdHN2Yy5maWx0ZXJEYXRhID0ge1x0XCJhcnRpc3RcIjogXCJcIixcblx0XHRcdFx0XHRcdFx0XCJ0aXRsZVwiOiBcIlwiLFxuXHRcdFx0XHRcdFx0XHR9O1xuXG5cdFx0YW5ndWxhci5mb3JFYWNoKGluc3RTdmMuaW5zdHJ1bWVudHMsIGZ1bmN0aW9uKHZhbHVlLCBrZXkpXG5cdFx0e1xuXHRcdFx0c3ZjLmZpbHRlckRhdGFbdmFsdWUuaWRdID0gdHJ1ZTtcblx0XHR9KTtcblx0fVxuXG5cdGZ1bmN0aW9uIF9pbml0KCkge1xuXHRcdHN2Yy5jcmVhdGVGaWx0ZXJEYXRhKCk7XG5cdH1cblxuXHRfaW5pdCgpO1xufSkiLCJhcHAuc2VydmljZShcImluc3RydW1lbnRTZXJ2aWNlXCIsIGZ1bmN0aW9uKCRodHRwKSB7XG5cdFxuXHQvL0dsb2JhbHNcblx0dmFyIHN2YyA9IHRoaXM7XG5cblx0Ly9Qcml2YXRlIGZ1bmN0aW9uc1xuXHRmdW5jdGlvbiBnZXREYXRhICh1cmwsIG9wdGlvbnMpIHtcblxuXHRcdCFvcHRpb25zID8gb3B0aW9ucyA9IHt9IDogXCJcIjtcblxuXHRcdHJldHVybiAkaHR0cC5nZXQodXJsLCBvcHRpb25zKVxuXHR9XG5cblx0Ly9TdmMgZnVuY3Rpb25zXG5cdHN2Yy5nZXRJbnN0cnVtZW50cyA9IGZ1bmN0aW9uICgpIHtcblxuXHRcdHZhciB1cmwgPSBDT05TVEFOVFMuQVBJX0JBU0VfVVJMICsgXCIvaW5zdHJ1bWVudHNcIjtcblx0XHRcblx0c3ZjLmluc3RydW1lbnRzID0gZ2V0RGF0YSh1cmwpO1xuXHR9XG5cblx0c3ZjLmluc3RydW1lbnRzID0gW3tcblx0XHRcdFx0XHRcdFx0XCJuYW1lXCI6XCJMZWFkLWd1aXRhclwiLFxuXHRcdFx0XHRcdFx0XHRcImlkXCI6MVxuXHRcdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFx0XCJuYW1lXCI6XCJEcnVtXCIsXG5cdFx0XHRcdFx0XHRcdFwiaWRcIjoyXG5cdFx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0XHRcIm5hbWVcIjpcIkJhc3NcIixcblx0XHRcdFx0XHRcdFx0XCJpZFwiOjNcblx0XHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdFwibmFtZVwiOlwiS2V5c1wiLFxuXHRcdFx0XHRcdFx0XHRcImlkXCI6NFxuXHRcdFx0XHRcdFx0fV07XG59KSIsImFwcC5zZXJ2aWNlKFwic29sb1NlcnZpY2VcIiwgZnVuY3Rpb24oJGh0dHApIHtcblx0XG5cdC8vR2xvYmFsc1xuXHR2YXIgc3ZjID0gdGhpcztcblxuXHQvL1ByaXZhdGUgZnVuY3Rpb25zXG5cdGZ1bmN0aW9uIGdldERhdGEgKHVybCwgb3B0aW9ucykge1xuXG5cdFx0IW9wdGlvbnMgPyBvcHRpb25zID0ge30gOiBcIlwiO1xuXG5cdFx0cmV0dXJuICRodHRwLmdldCh1cmwsIG9wdGlvbnMpXG5cdH1cblxuXHQvL1N2YyBmdW5jdGlvbnNcblx0c3ZjLmdldFRyYWNrcyA9IGZ1bmN0aW9uICgpIHtcblxuXHRcdHZhciB1cmwgPSBDT05TVEFOVFMuQVBJX0JBU0VfVVJMICsgXCIvdHJhY2tzXCI7XG5cdFx0XG5cdFx0cmV0dXJuIGdldERhdGEodXJsKTtcblx0fVxuXG5cdHN2Yy5nZXRUcmFja0J5SWQgPSBmdW5jdGlvbiAoaWQpIHtcblxuXHRcdHZhciB1cmwgPSBDT05TVEFOVFMuQVBJX0JBU0VfVVJMICsgXCIvdHJhY2tzL1wiICsgaWQ7XG5cblx0XHRyZXR1cm4gZ2V0RGF0YSh1cmwpO1xuXHR9XG59KSIsImFwcC5zZXJ2aWNlKFwidXNlclNlcnZpY2VcIiwgZnVuY3Rpb24oJGh0dHApIHtcdFxyXG5cdFxyXG5cdHZhciBzdmMgPSB0aGlzO1xyXG5cclxuXHRzdmMuZ2V0VXNlciA9IGZ1bmN0aW9uKClcclxuXHR7XHJcblx0XHRyZXR1cm4gJGh0dHAuZ2V0KENPTlNUQU5UUy5BUElfQkFTRV9VUkwgKyBcIi91c2VyXCIpO1xyXG5cdH1cclxuXHJcblx0c3ZjLnVwZGF0ZVVzZXIgPSBmdW5jdGlvbihkYXRhKVxyXG5cdHtcclxuXHRcdHJldHVybiAkaHR0cC5wb3N0KENPTlNUQU5UUy5BUElfQkFTRV9VUkwgKyBcIi91c2VyXCIsIGRhdGEpO1xyXG5cdH1cclxufSkiLCJhcHAuZGlyZWN0aXZlKFwiZGNiQmFuZFwiLCBmdW5jdGlvbihiYW5kU2VydmljZSkge1xyXG5cdHJldHVybiB7XHJcblx0XHRyZXN0cmljdDogXCJFXCIsXHJcblx0XHR0ZW1wbGF0ZVVybDogXCJhcHAvZGlyZWN0aXZlcy9kY2ItYmFuZC9kY2ItYmFuZC5odG1sXCIsXHJcblx0XHRyZXBsYWNlOiB0cnVlLFxyXG5cdFx0c2NvcGU6IHt9LFxyXG5cdFx0Y29udHJvbGxlckFzOiBcImJhbmRcIixcclxuXHRcdGNvbnRyb2xsZXI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR2YXIgdm0gPSB0aGlzO1xyXG5cdFx0XHR2YXIgYmFuZFN2YyA9IGJhbmRTZXJ2aWNlO1xyXG5cclxuXHRcdFx0ZnVuY3Rpb24gX2luaXQoKSB7XHJcblx0XHRcdFx0dm0udmFsdWUgPSBcIk5ld0JhbmRcIjtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0X2luaXQoKTtcclxuXHRcdH1cclxuXHR9XHJcbn0pIiwiYXBwLmRpcmVjdGl2ZShcImRjYkhlYWRlclwiLCBmdW5jdGlvbihiYW5kU2VydmljZSkge1xyXG5cdHJldHVybiB7XHJcblx0XHRyZXN0cmljdDogXCJFXCIsXHJcblx0XHR0ZW1wbGF0ZVVybDogXCJhcHAvZGlyZWN0aXZlcy9kY2ItaGVhZGVyL2RjYi1oZWFkZXIuaHRtbFwiLFxyXG5cdFx0cmVwbGFjZTogdHJ1ZSxcclxuXHRcdHNjb3BlOiB7fSxcclxuXHRcdGNvbnRyb2xsZXJBczogXCJoZWFkXCIsXHJcblx0XHRjb250cm9sbGVyOiBmdW5jdGlvbigkc2NvcGUsIHVzZXJTZXJ2aWNlLCBhdXRoU2VydmljZSwgJGF1dGgsICRyb290U2NvcGUpIHtcclxuXHRcdFx0XHJcblx0XHRcdHZhciB2bSBcdFx0XHQ9IHRoaXM7XHJcblx0XHRcdHZhciB1c2VyU3ZjIFx0PSB1c2VyU2VydmljZTtcclxuXHRcdFx0dmFyIGF1dGhTdmMgXHQ9IGF1dGhTZXJ2aWNlO1xyXG5cdFx0XHR2YXIgYmFuZFN2YyBcdD0gYmFuZFNlcnZpY2U7XHJcblxyXG5cdFx0XHRmdW5jdGlvbiBfaW5pdCgpIHtcclxuXHRcdFx0XHR2bS50cmFja0FycmF5ID0gYmFuZFN2Yy50cmFja0FycmF5O1xyXG5cdFx0XHRcdHZtLnRyYWNrQXJyYXlDb3VudCA9IGJhbmRTdmMudHJhY2tBcnJheUNvdW50O1xyXG5cclxuXHRcdFx0XHRpZigkYXV0aC5pc0F1dGhlbnRpY2F0ZWQoKSlcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHR1c2VyU3ZjLmdldFVzZXIoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcblx0XHRcdFx0XHRcdCRyb290U2NvcGUudXNlcm5hbWUgPSBkYXRhLmRhdGEudXNlcm5hbWU7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHZtLnNob3dMb2dpbiA9IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0XHQkKCcjbG9naW5fbW9kYWwnKS5tb2RhbCgpO1xyXG5cdFx0XHRcdCQoJyNsb2dpbl9tb2RhbCcpLm1vZGFsKCdvcGVuJyk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHZtLmxvZ291dCA9IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0XHRhdXRoU3ZjLmxvZ291dCgpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR2bS5zaG93UmVnaXN0ZXIgPSBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0JCgnI3JlZ2lzdGVyX21vZGFsJykubW9kYWwoKTtcclxuXHRcdFx0XHQkKCcjcmVnaXN0ZXJfbW9kYWwnKS5tb2RhbCgnb3BlbicpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR2bS5pc0F1dGhlbnRpY2F0ZWQgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRyZXR1cm4gJGF1dGguaXNBdXRoZW50aWNhdGVkKCk7XHJcblx0XHRcdH07XHJcblxyXG5cdFx0XHRfaW5pdCgpO1xyXG5cclxuXHRcdFx0Ly9XYXRjaGVzXHJcblx0XHRcdCRzY29wZS4kd2F0Y2goXHJcblx0XHRcdFx0ZnVuY3Rpb24gKCkgeyByZXR1cm4gYXV0aFN2Yy51c2VyIH0sIFxyXG5cdFx0XHRcdGZ1bmN0aW9uICgpIHtcclxuXHJcblx0XHRcdFx0XHR2bS51c2VyID0gYXV0aFN2Yy51c2VyO1xyXG5cdFx0XHRcdFx0Ly9jb25zb2xlLmxvZyh2bS51c2VyKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdH1cclxuXHR9XHJcbn0pIiwiYXBwLmRpcmVjdGl2ZShcImRjYkxvZ2luXCIsIGZ1bmN0aW9uKCkge1xyXG5cdHJldHVybiB7XHJcblx0XHRyZXN0cmljdDogXCJFXCIsXHJcblx0XHR0ZW1wbGF0ZVVybDogXCJhcHAvZGlyZWN0aXZlcy9kY2ItbG9naW4vZGNiLWxvZ2luLmh0bWxcIixcclxuXHRcdHJlcGxhY2U6IHRydWUsXHJcblx0XHRzY29wZToge30sXHJcblx0XHRjb250cm9sbGVyQXM6IFwibG9naW5cIixcclxuXHRcdGNvbnRyb2xsZXI6IGZ1bmN0aW9uKCRhdXRoLCAkc2NvcGUsICRyb290U2NvcGUsIHVzZXJTZXJ2aWNlLCBhdXRoU2VydmljZSwgJGNvb2tpZXMpIHtcclxuXHRcdFx0dmFyIHZtIFx0XHRcdD0gdGhpcztcclxuXHRcdFx0dmFyIHVzZXJTdmMgXHQ9IHVzZXJTZXJ2aWNlO1xyXG5cdFx0XHR2YXIgYXV0aFN2YyBcdD0gYXV0aFNlcnZpY2U7XHJcblx0XHRcdHZhciB0YXJnZXQgXHRcdD0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luLXNwaW5uZXInKTtcclxuXHJcblx0XHRcdHZhciBvcHRzID0ge1xyXG5cdCAgXHRcdFx0bGluZXM6IDEzIC8vIFRoZSBudW1iZXIgb2YgbGluZXMgdG8gZHJhd1xyXG5cdFx0XHRcdCwgbGVuZ3RoOiAyOCAvLyBUaGUgbGVuZ3RoIG9mIGVhY2ggbGluZVxyXG5cdFx0XHRcdCwgd2lkdGg6IDE0IC8vIFRoZSBsaW5lIHRoaWNrbmVzc1xyXG5cdFx0XHRcdCwgcmFkaXVzOiA0MiAvLyBUaGUgcmFkaXVzIG9mIHRoZSBpbm5lciBjaXJjbGVcclxuXHRcdFx0XHQsIHNjYWxlOiAwLjQgLy8gU2NhbGVzIG92ZXJhbGwgc2l6ZSBvZiB0aGUgc3Bpbm5lclxyXG5cdFx0XHRcdCwgY29ybmVyczogMSAvLyBDb3JuZXIgcm91bmRuZXNzICgwLi4xKVxyXG5cdFx0XHRcdCwgY29sb3I6ICcjMDAwJyAvLyAjcmdiIG9yICNycmdnYmIgb3IgYXJyYXkgb2YgY29sb3JzXHJcblx0XHRcdFx0LCBvcGFjaXR5OiAwLjI1IC8vIE9wYWNpdHkgb2YgdGhlIGxpbmVzXHJcblx0XHRcdFx0LCByb3RhdGU6IDAgLy8gVGhlIHJvdGF0aW9uIG9mZnNldFxyXG5cdFx0XHRcdCwgZGlyZWN0aW9uOiAxIC8vIDE6IGNsb2Nrd2lzZSwgLTE6IGNvdW50ZXJjbG9ja3dpc2VcclxuXHRcdFx0XHQsIHNwZWVkOiAxIC8vIFJvdW5kcyBwZXIgc2Vjb25kXHJcblx0XHRcdFx0LCB0cmFpbDogNjAgLy8gQWZ0ZXJnbG93IHBlcmNlbnRhZ2VcclxuXHRcdFx0XHQsIGZwczogMjAgLy8gRnJhbWVzIHBlciBzZWNvbmQgd2hlbiB1c2luZyBzZXRUaW1lb3V0KCkgYXMgYSBmYWxsYmFjayBmb3IgQ1NTXHJcblx0XHRcdFx0LCB6SW5kZXg6IDJlOSAvLyBUaGUgei1pbmRleCAoZGVmYXVsdHMgdG8gMjAwMDAwMDAwMClcclxuXHRcdFx0XHQsIGNsYXNzTmFtZTogJ3NwaW5uZXInIC8vIFRoZSBDU1MgY2xhc3MgdG8gYXNzaWduIHRvIHRoZSBzcGlubmVyXHJcblx0XHRcdFx0LCB0b3A6ICc2MCUnIC8vIFRvcCBwb3NpdGlvbiByZWxhdGl2ZSB0byBwYXJlbnRcclxuXHRcdFx0XHQsIGxlZnQ6ICc1MCUnIC8vIExlZnQgcG9zaXRpb24gcmVsYXRpdmUgdG8gcGFyZW50XHJcblx0XHRcdFx0LCBzaGFkb3c6IGZhbHNlIC8vIFdoZXRoZXIgdG8gcmVuZGVyIGEgc2hhZG93XHJcblx0XHRcdFx0LCBod2FjY2VsOiBmYWxzZSAvLyBXaGV0aGVyIHRvIHVzZSBoYXJkd2FyZSBhY2NlbGVyYXRpb25cclxuXHRcdFx0XHQsIHBvc2l0aW9uOiAnYWJzb2x1dGUnIC8vIEVsZW1lbnQgcG9zaXRpb25pbmdcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly9Qcml2YXRlIGZ1bmN0aW9uc1xyXG5cdFx0XHRmdW5jdGlvbiBsb2dpbiAodG9rZW4sIGlkLCB1c2VybmFtZSwgZW1haWwpIHtcclxuXHJcblx0XHRcdFx0dmFyIGV4cGlyYXRpb25UaW1lID0gbmV3IERhdGUoKTtcclxuXHRcdFx0XHRleHBpcmF0aW9uVGltZSA9IGV4cGlyYXRpb25UaW1lLnNldFRpbWUoZXhwaXJhdGlvblRpbWUuZ2V0VGltZSgpICsgKHRva2VuW1wiZXhwaXJlc19pblwiXSAqIDEwMDApKTtcclxuXHRcdFx0XHRleHBpcmF0aW9uVGltZSA9IG5ldyBEYXRlKGV4cGlyYXRpb25UaW1lKTtcclxuXHJcblx0XHRcdFx0dmFyIHVzZXJEYXRhID0ge1xyXG5cclxuXHRcdFx0XHRcdHRva2VuOiB0b2tlbixcclxuXHRcdFx0XHRcdHVzZXJJZDogaWQsXHJcblx0XHRcdFx0XHR1c2VybmFtZTogdXNlcm5hbWUsXHJcblx0XHRcdFx0XHRlbWFpbDogZW1haWwsXHJcblx0XHRcdFx0XHQvL2lzQWRtaW46IGRhdGEuZGF0YS5pc0FkbWluXHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRjb25zb2xlLmxvZyh1c2VyRGF0YS50b2tlbik7XHJcblxyXG5cdFx0XHRcdGF1dGhTdmMudXNlciA9IHVzZXJEYXRhO1xyXG5cclxuXHRcdFx0XHQkY29va2llcy5wdXRPYmplY3QoXCJ1c2VyXCIsIHVzZXJEYXRhLCB7IGV4cGlyZXM6IGV4cGlyYXRpb25UaW1lIH0pO1xyXG5cdFx0XHRcdCRyb290U2NvcGUuaXNMb2dnZWRJbiA9IHRydWU7XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0Ly9DaGVjayBpZiByZXR1cm5lZCB1c2VyIGlzIEFkbWluXHJcblx0XHRcdFx0dXNlckRhdGEuaXNBZG1pbiA9PSBcIjFcIiA/ICRyb290U2NvcGUuaXNBZG1pbiA9IHRydWUgOiAkcm9vdFNjb3BlLmlzQWRtaW4gPSBmYWxzZTtcclxuXHRcdFx0fVxyXG5cclxuXHJcblx0XHRcdC8vVm0gZnVuY3Rpb25zXHJcblx0ICAgICAgICB2bS5sb2dpbiA9IGZ1bmN0aW9uKCkge1xyXG5cdCAgICAgICAgXHR2YXIgc3Bpbm5lciA9IG5ldyBTcGlubmVyKG9wdHMpLnNwaW4odGFyZ2V0KTtcclxuXHQgICAgICAgIFx0dm0ubG9hZGluZyBcdD0gdHJ1ZTtcclxuXHJcblx0ICAgICAgICAgICAgdmFyIGNyZWRlbnRpYWxzID0ge1xyXG5cdCAgICAgICAgICAgICAgICBlbWFpbDogdm0uZW1haWwsXHJcblx0ICAgICAgICAgICAgICAgIHBhc3N3b3JkOiB2bS5wYXNzd29yZFxyXG5cdCAgICAgICAgICAgIH1cclxuXHQgICAgICAgICAgICBcclxuXHQgICAgICAgICAgICBhdXRoU3ZjLmxvZ2luKGNyZWRlbnRpYWxzKTtcclxuXHJcblx0ICAgICAgICAgICAgLy9XYXRjaGVzXHJcblx0XHRcdFx0dmFyIHVucmVnaXN0ZXIgPSAkc2NvcGUuJHdhdGNoKFxyXG5cdFx0XHRcdFx0ZnVuY3Rpb24gKCkgeyByZXR1cm4gYXV0aFN2Yy5pc0xvZ2dlZEluIH0sIFxyXG5cdFx0XHRcdFx0ZnVuY3Rpb24gKCkge1xyXG5cclxuXHRcdFx0XHRcdFx0aWYoYXV0aFN2Yy5pc0xvZ2dlZEluKSBcclxuXHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdHZtLmxvYWRpbmcgPSBmYWxzZTtcclxuXHRcdFx0XHQgICAgICAgIFx0JCgnI2xvZ2luX21vZGFsJykubW9kYWwoKTtcclxuXHRcdFx0XHRcdFx0XHQkKCcjbG9naW5fbW9kYWwnKS5tb2RhbCgnY2xvc2UnKTtcclxuXHRcdFx0XHQgICAgICAgIFx0c3Bpbm5lci5zdG9wKCk7XHJcblx0XHRcdFx0ICAgICAgICBcdHVucmVnaXN0ZXIoKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRpZihhdXRoU3ZjLmlzTG9nZ2VkSW4gPT09IGZhbHNlKVxyXG5cdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0c3Bpbm5lci5zdG9wKCk7XHJcbiAgICAgICAgXHRcdFx0XHRcdHZtLmxvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICBcdFx0XHRcdFx0dW5yZWdpc3RlcigpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9LCB0cnVlKTtcclxuXHQgICAgICAgIH1cclxuXHRcdH1cclxuXHR9XHJcbn0pIiwiYXBwLmRpcmVjdGl2ZShcImRjYlJlZ2lzdGVyXCIsIGZ1bmN0aW9uKHVzZXJTZXJ2aWNlKSB7XHJcblx0cmV0dXJuIHtcclxuXHRcdHJlc3RyaWN0OiBcIkVcIixcclxuXHRcdHRlbXBsYXRlVXJsOiBcImFwcC9kaXJlY3RpdmVzL2RjYi1yZWdpc3Rlci9kY2ItcmVnaXN0ZXIuaHRtbFwiLFxyXG5cdFx0cmVwbGFjZTogdHJ1ZSxcclxuXHRcdHNjb3BlOiB7fSxcclxuXHRcdGNvbnRyb2xsZXJBczogXCJyZWdpc3RlclwiLFxyXG5cdFx0Y29udHJvbGxlcjogZnVuY3Rpb24oJGF1dGgsICRzY29wZSwgJHJvb3RTY29wZSwgdXNlclNlcnZpY2UsIGF1dGhTZXJ2aWNlKSB7XHJcblx0XHRcdHZhciB2bSBcdFx0XHQ9IHRoaXM7XHJcblx0XHRcdHZhciB1c2VyU3ZjIFx0PSB1c2VyU2VydmljZTtcclxuXHRcdFx0dmFyIGF1dGhTdmMgXHQ9IGF1dGhTZXJ2aWNlO1xyXG5cdFx0XHR2YXIgdGFyZ2V0IFx0XHQ9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZWdpc3Rlci1zcGlubmVyJyk7XHJcblxyXG5cdFx0XHR2YXIgb3B0cyA9IHtcclxuXHQgIFx0XHRcdGxpbmVzOiAxMyAvLyBUaGUgbnVtYmVyIG9mIGxpbmVzIHRvIGRyYXdcclxuXHRcdFx0XHQsIGxlbmd0aDogMjggLy8gVGhlIGxlbmd0aCBvZiBlYWNoIGxpbmVcclxuXHRcdFx0XHQsIHdpZHRoOiAxNCAvLyBUaGUgbGluZSB0aGlja25lc3NcclxuXHRcdFx0XHQsIHJhZGl1czogNDIgLy8gVGhlIHJhZGl1cyBvZiB0aGUgaW5uZXIgY2lyY2xlXHJcblx0XHRcdFx0LCBzY2FsZTogMC40IC8vIFNjYWxlcyBvdmVyYWxsIHNpemUgb2YgdGhlIHNwaW5uZXJcclxuXHRcdFx0XHQsIGNvcm5lcnM6IDEgLy8gQ29ybmVyIHJvdW5kbmVzcyAoMC4uMSlcclxuXHRcdFx0XHQsIGNvbG9yOiAnIzAwMCcgLy8gI3JnYiBvciAjcnJnZ2JiIG9yIGFycmF5IG9mIGNvbG9yc1xyXG5cdFx0XHRcdCwgb3BhY2l0eTogMC4yNSAvLyBPcGFjaXR5IG9mIHRoZSBsaW5lc1xyXG5cdFx0XHRcdCwgcm90YXRlOiAwIC8vIFRoZSByb3RhdGlvbiBvZmZzZXRcclxuXHRcdFx0XHQsIGRpcmVjdGlvbjogMSAvLyAxOiBjbG9ja3dpc2UsIC0xOiBjb3VudGVyY2xvY2t3aXNlXHJcblx0XHRcdFx0LCBzcGVlZDogMSAvLyBSb3VuZHMgcGVyIHNlY29uZFxyXG5cdFx0XHRcdCwgdHJhaWw6IDYwIC8vIEFmdGVyZ2xvdyBwZXJjZW50YWdlXHJcblx0XHRcdFx0LCBmcHM6IDIwIC8vIEZyYW1lcyBwZXIgc2Vjb25kIHdoZW4gdXNpbmcgc2V0VGltZW91dCgpIGFzIGEgZmFsbGJhY2sgZm9yIENTU1xyXG5cdFx0XHRcdCwgekluZGV4OiAyZTkgLy8gVGhlIHotaW5kZXggKGRlZmF1bHRzIHRvIDIwMDAwMDAwMDApXHJcblx0XHRcdFx0LCBjbGFzc05hbWU6ICdzcGlubmVyJyAvLyBUaGUgQ1NTIGNsYXNzIHRvIGFzc2lnbiB0byB0aGUgc3Bpbm5lclxyXG5cdFx0XHRcdCwgdG9wOiAnNjAlJyAvLyBUb3AgcG9zaXRpb24gcmVsYXRpdmUgdG8gcGFyZW50XHJcblx0XHRcdFx0LCBsZWZ0OiAnNTAlJyAvLyBMZWZ0IHBvc2l0aW9uIHJlbGF0aXZlIHRvIHBhcmVudFxyXG5cdFx0XHRcdCwgc2hhZG93OiBmYWxzZSAvLyBXaGV0aGVyIHRvIHJlbmRlciBhIHNoYWRvd1xyXG5cdFx0XHRcdCwgaHdhY2NlbDogZmFsc2UgLy8gV2hldGhlciB0byB1c2UgaGFyZHdhcmUgYWNjZWxlcmF0aW9uXHJcblx0XHRcdFx0LCBwb3NpdGlvbjogJ2Fic29sdXRlJyAvLyBFbGVtZW50IHBvc2l0aW9uaW5nXHJcblx0XHRcdH1cclxuXHJcblxyXG5cdFx0XHRcclxuXHRcdFx0dm0ucmVnaXN0ZXIgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHR2YXIgc3Bpbm5lciA9IG5ldyBTcGlubmVyKG9wdHMpLnNwaW4odGFyZ2V0KTtcclxuXHQgICAgICAgIFx0dm0ubG9hZGluZyBcdD0gdHJ1ZTtcclxuXHJcblx0XHRcdFx0dmFyIHVzZXIgPSB7XHJcblx0XHRcdFx0ICBcdHVzZXJuYW1lOiB2bS51c2VybmFtZSxcclxuXHRcdFx0XHQgIFx0ZW1haWw6IHZtLmVtYWlsLFxyXG5cdFx0XHRcdCAgXHRwYXNzd29yZDogdm0ucGFzc3dvcmRcclxuXHRcdFx0XHR9O1xyXG5cclxuXHRcdFx0XHQkYXV0aC5zaWdudXAodXNlcikudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xyXG5cdFx0XHRcdFx0Ly8gUmVnaXN0cmF0aW9uIHN1Y2Nlc3NcclxuXHRcdFx0XHRcdGF1dGhTdmMubG9naW4odXNlcik7XHJcblxyXG5cdFx0ICAgICAgICAgICAgLy9XYXRjaGVzXHJcblx0XHRcdFx0XHR2YXIgdW5yZWdpc3RlciA9ICRzY29wZS4kd2F0Y2goXHJcblx0XHRcdFx0XHRcdGZ1bmN0aW9uICgpIHsgcmV0dXJuIGF1dGhTdmMuaXNMb2dnZWRJbiB9LCBcclxuXHRcdFx0XHRcdFx0ZnVuY3Rpb24gKCkge1xyXG5cclxuXHRcdFx0XHRcdFx0XHRpZihhdXRoU3ZjLmlzTG9nZ2VkSW4pIFxyXG5cdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdHZtLmxvYWRpbmcgPSBmYWxzZTtcclxuXHRcdFx0XHRcdCAgICAgICAgXHQkKCcjcmVnaXN0ZXJfbW9kYWwnKS5tb2RhbCgpO1xyXG5cdFx0XHRcdFx0XHRcdFx0JCgnI3JlZ2lzdGVyX21vZGFsJykubW9kYWwoJ2Nsb3NlJyk7XHJcblx0XHRcdFx0XHQgICAgICAgIFx0c3Bpbm5lci5zdG9wKCk7XHJcblx0XHRcdFx0XHQgICAgICAgIFx0dW5yZWdpc3RlcigpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRpZihhdXRoU3ZjLmlzTG9nZ2VkSW4gPT09IGZhbHNlKVxyXG5cdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdHNwaW5uZXIuc3RvcCgpO1xyXG5cdCAgICAgICAgXHRcdFx0XHRcdHZtLmxvYWRpbmcgPSBmYWxzZTtcclxuXHQgICAgICAgIFx0XHRcdFx0XHR1bnJlZ2lzdGVyKCk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9LCB0cnVlKTtcclxuXHRcdFx0XHR9KVxyXG5cdFx0XHRcdC5jYXRjaChmdW5jdGlvbihyZXNwb25zZSkge1xyXG5cdFx0XHRcdFx0Ly8gUmVnaXN0cmF0aW9uIGZhaWxlZFxyXG5cdFx0XHRcdCAgXHRzcGlubmVyLnN0b3AoKTtcclxuXHRcdFx0XHQgIFx0dm0ubG9hZGluZyA9IGZhbHNlO1xyXG5cdFx0XHRcdCAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcbn0pIl19
