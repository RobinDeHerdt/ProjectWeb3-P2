var app=angular.module("app",["ui.router","satellizer"]),CONSTANTS=function(){var e={};return e.API_BASE_URL="http://discoverbandapi.int/public/api",e}();app.config(["$stateProvider","$urlRouterProvider","$authProvider",function(e,t,r){r.loginUrl=CONSTANTS.API_BASE_URL+"/authenticate",t.otherwise("/"),e.state("home",{url:"/",templateUrl:"app/pages/home.html",controller:"homeController as home"}).state("solo",{url:"/solo",templateUrl:"app/pages/solo.html",controller:"soloController as solo"}).state("merged",{url:"/merged",templateUrl:"app/pages/merged.html",controller:"mergedController as merged"})}]),app.controller("homeController",["instrumentService","filterService",function(e,t){function r(){n.filterData=a.filterData}var n=this,a=t;r()}]),app.controller("mergeController",function(){function e(){}e()}),app.controller("mergedController",function(){function e(){t.test="Merged"}var t=this;e()}),app.controller("soloController",["$scope","bandService","soloService","instrumentService","filterService",function(e,t,r,n,a){function o(){d.getTracks().then(function(e){s.soloTracks=e.data,s.filteredTracks=s.soloTracks,i()},function(e){console.log(e)})}function i(){s.filteredTracks=[],angular.forEach(s.soloTracks,function(e,t){goodSearch=!0,""!=!s.filterData.artist||e.artist.name.match(new RegExp(s.filterData.artist,"i"))||(goodSearch=!1),""!=!s.filterData.title||e.songname.match(new RegExp(s.filterData.title,"i"))||(goodSearch=!1),s.filterData[e.instrument_id]||(goodSearch=!1),goodSearch&&s.filteredTracks.push(e)})}function c(e,t,r){for(var n=0,a=e.length;n<a;n++)if(e[n][r]===t)return n;return-1}function l(){o(),s.instruments=p.instruments,s.filterData=f.filterData,s.bandTrackIdArray=[],angular.forEach(u.trackArray,function(e,t){s.bandTrackIdArray.push(e.id)})}var s=this,u=t,d=r,p=n,f=a;s.addToBand=function(e){u.trackArray.push(e),angular.forEach(u.trackArray,function(e,t){s.bandTrackIdArray.push(e.id)}),console.log("Track added to new band: "+e),console.log(u.trackArray)},s.removeFromBand=function(e){index=c(u.trackArray,e.id,"id"),index>-1&&(u.trackArray.splice(index,1),s.bandTrackArray=u.trackArray,intIndex=s.bandTrackIdArray.indexOf(e.id),intIndex>-1&&s.bandTrackIdArray.splice(intIndex,1)),console.log("Track removed from new band: "+e),console.log(u.trackArray)},e.$watch(function(){return s.filterData},function(){s.filterData&&i()},!0),s.track1=new Audio("dist/audio/Behemoth - Conquer All - Drum.mp3"),s.track2=new Audio("dist/audio/Behemoth - Conquer All - Guitar.mp3"),l()}]),app.filter("band",function(){return function(e,t){var r=!1;return angular.forEach(t,function(t,n){t==e&&(r=!0)}),r}}),app.service("bandService",function(){var e=this;e.testValue="This value is from a service!",e.trackArray=[],e.testFunction=function(){alert("Test function called from inside service!")}}),app.service("filterService",["instrumentService",function(e){function t(){r.createFilterData()}var r=this,n=e;r.createFilterData=function(){r.filterData={artist:"",title:""},angular.forEach(n.instruments,function(e,t){r.filterData[e.id]=!0})},t()}]),app.service("instrumentService",["$http",function(e){function t(t,r){return r?"":r={},e.get(t,r)}var r=this;r.getInstruments=function(){var e=CONSTANTS.API_BASE_URL+"/instruments";r.instruments=t(e)},r.instruments=[{name:"Lead-guitar",id:1},{name:"Drum",id:2},{name:"Bass",id:3},{name:"Keys",id:4}]}]),app.service("loginService",["$http",function(e){var t=this;t.getUser=function(){return e.get(CONSTANTS.API_BASE_URL+"/user")}}]),app.service("soloService",["$http",function(e){function t(t,r){return r?"":r={},e.get(t,r)}var r=this;r.getTracks=function(){var e=CONSTANTS.API_BASE_URL+"/tracks";return t(e)},r.getTrackById=function(e){var r=CONSTANTS.API_BASE_URL+"/tracks/"+e;return t(r)}}]),app.directive("dcbHeader",function(){return{restrict:"E",templateUrl:"app/directives/dcb-header/dcb-header.html",replace:!0,scope:{},controllerAs:"head",controller:["loginService","$auth","$rootScope",function(e,t,r){function n(){t.isAuthenticated()&&o.getUser().then(function(e){r.username=e.data.username}),a.value="This is a directive test value!"}var a=this,o=e;a.showLogin=function(){$("#login_modal").modal(),$("#login_modal").modal("open")},a.logout=function(){t.logout()},a.showRegister=function(){$("#register_modal").modal(),$("#register_modal").modal("open")},a.isAuthenticated=function(){return t.isAuthenticated()},n()}]}}),app.directive("dcbLogin",function(){return{restrict:"E",templateUrl:"app/directives/dcb-login/dcb-login.html",replace:!0,scope:{},controllerAs:"login",controller:["$auth","loginService","$rootScope",function(e,t,r){var n=this,a=t,o=document.getElementById("login-spinner"),i={lines:13,length:28,width:14,radius:42,scale:.4,corners:1,color:"#000",opacity:.25,rotate:0,direction:1,speed:1,trail:60,fps:20,zIndex:2e9,className:"spinner",top:"60%",left:"50%",shadow:!1,hwaccel:!1,position:"absolute"};n.login=function(){var t=new Spinner(i).spin(o);n.loading=!0;var c={email:n.email,password:n.password};e.login(c).then(function(e){t.stop(),n.loading=!1,$("#login_modal").modal(),$("#login_modal").modal("close"),a.getUser().then(function(e){r.username=e.data.username})},function(e){t.stop(),n.loading=!1,console.log(e)})}}]}}),app.directive("dcbRegister",function(){return{restrict:"E",templateUrl:"app/directives/dcb-register/dcb-register.html",replace:!0,scope:{},controllerAs:"register",controller:function(){}}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNvbmZpZy5qcyIsInJvdXRlcy5qcyIsImhvbWVDb250cm9sbGVyLmpzIiwibWVyZ2VDb250cm9sbGVyLmpzIiwibWVyZ2VkQ29udHJvbGxlci5qcyIsInNvbG9Db250cm9sbGVyLmpzIiwiYmFuZEZpbHRlci5qcyIsImJhbmRTZXJ2aWNlLmpzIiwiZmlsdGVyU2VydmljZS5qcyIsImluc3RydW1lbnRTZXJ2aWNlLmpzIiwibG9naW5TZXJ2aWNlLmpzIiwic29sb1NlcnZpY2UuanMiLCJkY2ItaGVhZGVyL2RjYi1oZWFkZXIuanMiLCJkY2ItbG9naW4vZGNiLWxvZ2luLmpzIiwiZGNiLXJlZ2lzdGVyL2RjYi1yZWdpc3Rlci5qcyJdLCJuYW1lcyI6WyJhcHAiLCJhbmd1bGFyIiwibW9kdWxlIiwiQ09OU1RBTlRTIiwiQVBJX0JBU0VfVVJMIiwiY29uZmlnIiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCIkYXV0aFByb3ZpZGVyIiwibG9naW5VcmwiLCJvdGhlcndpc2UiLCJzdGF0ZSIsInVybCIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsImluc3RydW1lbnRTZXJ2aWNlIiwiZmlsdGVyU2VydmljZSIsIl9pbml0Iiwidm0iLCJmaWx0ZXJEYXRhIiwiZmx0U3ZjIiwidGhpcyIsInRlc3QiLCIkc2NvcGUiLCJiYW5kU2VydmljZSIsInNvbG9TZXJ2aWNlIiwiZ2V0U29sb1RyYWNrcyIsInNvbG9TdmMiLCJnZXRUcmFja3MiLCJ0aGVuIiwiZGF0YSIsInNvbG9UcmFja3MiLCJmaWx0ZXJlZFRyYWNrcyIsImZpbHRlciIsImVycm9yIiwiY29uc29sZSIsImxvZyIsImZvckVhY2giLCJ0cmFjayIsImtleSIsImdvb2RTZWFyY2giLCJhcnRpc3QiLCJuYW1lIiwibWF0Y2giLCJSZWdFeHAiLCJ0aXRsZSIsInNvbmduYW1lIiwiaW5zdHJ1bWVudF9pZCIsInB1c2giLCJhcnJheU9iamVjdEluZGV4T2YiLCJteUFycmF5Iiwic2VhcmNoVGVybSIsInByb3BlcnR5IiwiaSIsImxlbiIsImxlbmd0aCIsImluc3RydW1lbnRzIiwiaW5zdFN2YyIsImJhbmRUcmFja0lkQXJyYXkiLCJiYW5kU3ZjIiwidHJhY2tBcnJheSIsImlkIiwiYWRkVG9CYW5kIiwicmVtb3ZlRnJvbUJhbmQiLCJpbmRleCIsInNwbGljZSIsImJhbmRUcmFja0FycmF5IiwiaW50SW5kZXgiLCJpbmRleE9mIiwiJHdhdGNoIiwidHJhY2sxIiwiQXVkaW8iLCJ0cmFjazIiLCJ0cmFja0lkIiwibGlzdCIsInJldHVyblZhbHVlIiwic2VydmljZSIsInN2YyIsInRlc3RWYWx1ZSIsInRlc3RGdW5jdGlvbiIsImFsZXJ0IiwiY3JlYXRlRmlsdGVyRGF0YSIsInZhbHVlIiwiJGh0dHAiLCJnZXREYXRhIiwib3B0aW9ucyIsImdldCIsImdldEluc3RydW1lbnRzIiwiZ2V0VXNlciIsImdldFRyYWNrQnlJZCIsImRpcmVjdGl2ZSIsInJlc3RyaWN0IiwicmVwbGFjZSIsInNjb3BlIiwiY29udHJvbGxlckFzIiwibG9naW5TZXJ2aWNlIiwiJGF1dGgiLCIkcm9vdFNjb3BlIiwiaXNBdXRoZW50aWNhdGVkIiwibG9naW5TdmMiLCJ1c2VybmFtZSIsInNob3dMb2dpbiIsIiQiLCJtb2RhbCIsImxvZ291dCIsInNob3dSZWdpc3RlciIsInRhcmdldCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJvcHRzIiwibGluZXMiLCJ3aWR0aCIsInJhZGl1cyIsInNjYWxlIiwiY29ybmVycyIsImNvbG9yIiwib3BhY2l0eSIsInJvdGF0ZSIsImRpcmVjdGlvbiIsInNwZWVkIiwidHJhaWwiLCJmcHMiLCJ6SW5kZXgiLCJjbGFzc05hbWUiLCJ0b3AiLCJsZWZ0Iiwic2hhZG93IiwiaHdhY2NlbCIsInBvc2l0aW9uIiwibG9naW4iLCJzcGlubmVyIiwiU3Bpbm5lciIsInNwaW4iLCJsb2FkaW5nIiwiY3JlZGVudGlhbHMiLCJlbWFpbCIsInBhc3N3b3JkIiwic3RvcCJdLCJt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QUNqQ21FLEVBQVdHLFNBQVd0RSxFQUFLQSxLQUFLc0UsWUFHekIsU0FBU2xFLEdBRVJnRyxFQUFRTyxPQUNSdkgsRUFBR21ILFNBQVUsRUFDYmxHLFFBQVFDLElBQUlGLFdDM0QxQmxDLElBQUkwRixVQUFVLGNBQWUsV0FDNUIsT0FDQ0MsU0FBVSxJQUNWOUUsWUFBYSxnREFDYitFLFNBQVMsRUFDVEMsU0FDQUMsYUFBYyxXQUNkaEYsV0FBWSIsImZpbGUiOiJzY3JpcHRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKFwiYXBwXCIsIFtcInVpLnJvdXRlclwiLCBcInNhdGVsbGl6ZXJcIl0pOyIsInZhciBDT05TVEFOVFMgPSAoZnVuY3Rpb24gKCkge1xyXG5cdFxyXG5cdHZhciBtb2R1bGUgPSB7fTtcclxuXHJcblx0bW9kdWxlLkFQSV9CQVNFX1VSTCA9IFwiaHR0cDovL2Rpc2NvdmVyYmFuZGFwaS5pbnQvcHVibGljL2FwaVwiO1xyXG5cclxuXHRyZXR1cm4gbW9kdWxlO1xyXG59KCkpOyIsImFwcC5jb25maWcoZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlciwgJGF1dGhQcm92aWRlcikge1xyXG4gICRhdXRoUHJvdmlkZXIubG9naW5VcmwgPSBDT05TVEFOVFMuQVBJX0JBU0VfVVJMICsgJy9hdXRoZW50aWNhdGUnO1xyXG4gICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoXCIvXCIpO1xyXG5cclxuICAkc3RhdGVQcm92aWRlclxyXG4gICAgLnN0YXRlKCdob21lJywge1xyXG4gICAgICB1cmw6IFwiL1wiLFxyXG4gICAgICB0ZW1wbGF0ZVVybDogXCJhcHAvcGFnZXMvaG9tZS5odG1sXCIsXHJcbiAgICAgIGNvbnRyb2xsZXI6IFwiaG9tZUNvbnRyb2xsZXIgYXMgaG9tZVwiXHJcbiAgICB9KVxyXG4gIFx0LnN0YXRlKCdzb2xvJywge1xyXG4gICAgICB1cmw6IFwiL3NvbG9cIixcclxuICAgICAgdGVtcGxhdGVVcmw6IFwiYXBwL3BhZ2VzL3NvbG8uaHRtbFwiLFxyXG4gICAgICBjb250cm9sbGVyOiBcInNvbG9Db250cm9sbGVyIGFzIHNvbG9cIlxyXG4gICAgfSlcclxuICAgIC5zdGF0ZSgnbWVyZ2VkJywge1xyXG4gICAgICB1cmw6IFwiL21lcmdlZFwiLFxyXG4gICAgICB0ZW1wbGF0ZVVybDogXCJhcHAvcGFnZXMvbWVyZ2VkLmh0bWxcIixcclxuICAgICAgY29udHJvbGxlcjogXCJtZXJnZWRDb250cm9sbGVyIGFzIG1lcmdlZFwiXHJcbiAgICB9KVxyXG59KTsiLCJhcHAuY29udHJvbGxlcihcImhvbWVDb250cm9sbGVyXCIsIGZ1bmN0aW9uKGluc3RydW1lbnRTZXJ2aWNlLCBmaWx0ZXJTZXJ2aWNlKSB7XHJcblx0XHJcblx0dmFyIHZtID0gdGhpcztcclxuXHR2YXIgaW5zdFN2YyA9IGluc3RydW1lbnRTZXJ2aWNlO1xyXG5cdHZhciBmbHRTdmMgPSBmaWx0ZXJTZXJ2aWNlO1xyXG5cclxuXHRmdW5jdGlvbiBfaW5pdCgpIHtcclxuXHRcdC8vaW5zdFN2Yy5nZXRJbnN0cnVtZW50cygpO1xyXG5cclxuXHRcdHZtLmZpbHRlckRhdGEgPSBmbHRTdmMuZmlsdGVyRGF0YTtcclxuXHR9XHJcblxyXG5cdF9pbml0KCk7XHJcbn0pOyIsImFwcC5jb250cm9sbGVyKFwibWVyZ2VDb250cm9sbGVyXCIsIGZ1bmN0aW9uKCkge1xyXG5cdHZhciB2bSA9IHRoaXM7XHJcblxyXG5cdGZ1bmN0aW9uIF9pbml0KCkge1xyXG5cdFx0XHJcblx0fVxyXG5cclxuXHRfaW5pdCgpO1xyXG59KTsiLCJhcHAuY29udHJvbGxlcihcIm1lcmdlZENvbnRyb2xsZXJcIiwgZnVuY3Rpb24oKSB7XHJcblx0dmFyIHZtID0gdGhpcztcclxuXHJcblx0ZnVuY3Rpb24gX2luaXQoKSB7XHJcblx0XHR2bS50ZXN0ID0gXCJNZXJnZWRcIjtcclxuXHR9XHJcblxyXG5cdF9pbml0KCk7XHJcbn0pOyIsImFwcC5jb250cm9sbGVyKFwic29sb0NvbnRyb2xsZXJcIiwgZnVuY3Rpb24oJHNjb3BlLCBiYW5kU2VydmljZSwgc29sb1NlcnZpY2UsIGluc3RydW1lbnRTZXJ2aWNlLCBmaWx0ZXJTZXJ2aWNlKSB7XHJcblx0XHJcblx0dmFyIHZtID0gdGhpcztcclxuXHR2YXIgYmFuZFN2YyA9IGJhbmRTZXJ2aWNlO1xyXG5cdHZhciBzb2xvU3ZjID0gc29sb1NlcnZpY2U7XHJcblx0dmFyIGluc3RTdmMgPSBpbnN0cnVtZW50U2VydmljZTtcclxuXHR2YXIgZmx0U3ZjID0gZmlsdGVyU2VydmljZTtcclxuXHJcblx0Ly9Qcml2YXRlIGZ1bmN0aW9uc1xyXG5cdGZ1bmN0aW9uIHBsYXlBdWRpb0ZpbGUodHJhY2spXHJcblx0e1xyXG5cdFx0dHJhY2sucGxheSgpO1xyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gZ2V0U29sb1RyYWNrcygpXHJcblx0e1xyXG5cdFx0c29sb1N2Yy5nZXRUcmFja3MoKVxyXG5cdFx0XHQudGhlbihmdW5jdGlvbihkYXRhKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0dm0uc29sb1RyYWNrcyA9IGRhdGEuZGF0YTtcclxuXHRcdFx0XHR2bS5maWx0ZXJlZFRyYWNrcyA9IHZtLnNvbG9UcmFja3M7XHJcblx0XHRcdFx0ZmlsdGVyKCk7XHJcblx0XHRcdFxyXG5cdFx0XHR9LCBmdW5jdGlvbihlcnJvcilcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKGVycm9yKTtcclxuXHRcdFx0fSk7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBmaWx0ZXIoKVxyXG5cdHtcclxuXHRcdHZtLmZpbHRlcmVkVHJhY2tzID0gW107XHJcblxyXG5cdFx0YW5ndWxhci5mb3JFYWNoKHZtLnNvbG9UcmFja3MsIGZ1bmN0aW9uKHRyYWNrLCBrZXkpXHJcblx0XHR7XHJcblx0XHRcdC8vY29uc29sZS5sb2codHJhY2spO1xyXG5cdFx0XHRnb29kU2VhcmNoID0gdHJ1ZTtcclxuXHJcblx0XHRcdGlmKCF2bS5maWx0ZXJEYXRhLmFydGlzdCA9PSBcIlwiICYmICF0cmFjay5hcnRpc3QubmFtZS5tYXRjaChuZXcgUmVnRXhwKHZtLmZpbHRlckRhdGEuYXJ0aXN0LCBcImlcIikpKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0Z29vZFNlYXJjaCA9IGZhbHNlO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZighdm0uZmlsdGVyRGF0YS50aXRsZSA9PSBcIlwiICYmICF0cmFjay5zb25nbmFtZS5tYXRjaChuZXcgUmVnRXhwKHZtLmZpbHRlckRhdGEudGl0bGUsIFwiaVwiKSkpXHJcblx0XHRcdHtcclxuXHRcdFx0XHRnb29kU2VhcmNoID0gZmFsc2U7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmKCF2bS5maWx0ZXJEYXRhW3RyYWNrLmluc3RydW1lbnRfaWRdKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0Z29vZFNlYXJjaCA9IGZhbHNlO1xyXG5cdFx0XHR9XHJcblxyXG5cclxuXHRcdFx0aWYoZ29vZFNlYXJjaClcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHZtLmZpbHRlcmVkVHJhY2tzLnB1c2godHJhY2spO1xyXG5cdFx0XHR9XHJcblx0XHRcdC8vY29uc29sZS5sb2codm0uZmlsdGVyZWRUcmFja3MpO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBhcnJheU9iamVjdEluZGV4T2YobXlBcnJheSwgc2VhcmNoVGVybSwgcHJvcGVydHkpIHtcclxuICAgIFx0XHJcbiAgICBcdGZvcih2YXIgaSA9IDAsIGxlbiA9IG15QXJyYXkubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICBcdGlmIChteUFycmF5W2ldW3Byb3BlcnR5XSA9PT0gc2VhcmNoVGVybSkgcmV0dXJuIGk7XHJcbiAgICBcdH1cclxuXHJcbiAgICBcdHJldHVybiAtMTtcclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIF9pbml0KCkge1xyXG5cdFx0Z2V0U29sb1RyYWNrcygpO1xyXG5cdFx0dm0uaW5zdHJ1bWVudHMgPSBpbnN0U3ZjLmluc3RydW1lbnRzO1xyXG5cdFx0dm0uZmlsdGVyRGF0YSA9IGZsdFN2Yy5maWx0ZXJEYXRhO1xyXG5cdFx0dm0uYmFuZFRyYWNrSWRBcnJheSA9IFtdO1xyXG5cclxuXHRcdGFuZ3VsYXIuZm9yRWFjaChiYW5kU3ZjLnRyYWNrQXJyYXksIGZ1bmN0aW9uKHRyYWNrLCBrZXkpIHtcclxuXHRcdFx0dm0uYmFuZFRyYWNrSWRBcnJheS5wdXNoKHRyYWNrLmlkKTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vdm0udHJhY2sxLnBsYXkoKTtcclxuXHRcdC8vc2V0VGltZW91dChmdW5jdGlvbigpe3BsYXlBdWRpb0ZpbGUodm0udHJhY2syKX0sIDQwMCk7XHJcblx0fVxyXG5cclxuXHQvL1ZtIGZ1bmN0aW9uc1xyXG5cdHZtLmFkZFRvQmFuZCA9IGZ1bmN0aW9uKHRyYWNrKSB7XHJcblxyXG5cdFx0YmFuZFN2Yy50cmFja0FycmF5LnB1c2godHJhY2spO1xyXG5cdFx0YW5ndWxhci5mb3JFYWNoKGJhbmRTdmMudHJhY2tBcnJheSwgZnVuY3Rpb24odHJhY2ssIGtleSkge1xyXG5cdFx0XHR2bS5iYW5kVHJhY2tJZEFycmF5LnB1c2godHJhY2suaWQpO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0Y29uc29sZS5sb2coXCJUcmFjayBhZGRlZCB0byBuZXcgYmFuZDogXCIgKyB0cmFjayk7XHJcblx0XHRjb25zb2xlLmxvZyhiYW5kU3ZjLnRyYWNrQXJyYXkpO1xyXG5cdH1cclxuXHJcblx0dm0ucmVtb3ZlRnJvbUJhbmQgPSBmdW5jdGlvbih0cmFjaykge1xyXG5cdFx0XHJcblx0XHRpbmRleCA9IGFycmF5T2JqZWN0SW5kZXhPZihiYW5kU3ZjLnRyYWNrQXJyYXksIHRyYWNrLmlkLCBcImlkXCIpO1xyXG5cdFx0aWYgKGluZGV4ID4gLTEpIHtcclxuXHRcdFx0YmFuZFN2Yy50cmFja0FycmF5LnNwbGljZShpbmRleCwgMSk7XHJcblx0XHRcdHZtLmJhbmRUcmFja0FycmF5ID0gYmFuZFN2Yy50cmFja0FycmF5O1xyXG5cclxuXHRcdFx0aW50SW5kZXggPSB2bS5iYW5kVHJhY2tJZEFycmF5LmluZGV4T2YodHJhY2suaWQpO1xyXG5cdFx0XHRpZiAoaW50SW5kZXggPiAtMSkge1xyXG5cdFx0XHRcdHZtLmJhbmRUcmFja0lkQXJyYXkuc3BsaWNlKGludEluZGV4LCAxKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdGNvbnNvbGUubG9nKFwiVHJhY2sgcmVtb3ZlZCBmcm9tIG5ldyBiYW5kOiBcIiArIHRyYWNrKTtcclxuXHRcdGNvbnNvbGUubG9nKGJhbmRTdmMudHJhY2tBcnJheSk7XHJcblx0fVxyXG5cclxuXHQvL1dhdGNoZXNcclxuXHQkc2NvcGUuJHdhdGNoKFxyXG5cdFx0ZnVuY3Rpb24gKCkgeyByZXR1cm4gdm0uZmlsdGVyRGF0YSB9LCBcclxuXHRcdGZ1bmN0aW9uICgpIHtcclxuXHJcblx0XHRcdGlmKHZtLmZpbHRlckRhdGEpIFxyXG5cdFx0XHR7XHJcblx0XHRcdFx0ZmlsdGVyKCk7XHJcblx0XHRcdH1cclxuXHRcdH0sIHRydWUpO1xyXG5cclxuXHJcblxyXG5cdHZtLnRyYWNrMSA9IG5ldyBBdWRpbyhcImRpc3QvYXVkaW8vQmVoZW1vdGggLSBDb25xdWVyIEFsbCAtIERydW0ubXAzXCIpO1xyXG5cdHZtLnRyYWNrMiA9IG5ldyBBdWRpbyhcImRpc3QvYXVkaW8vQmVoZW1vdGggLSBDb25xdWVyIEFsbCAtIEd1aXRhci5tcDNcIik7XHJcblxyXG5cclxuXHRfaW5pdCgpO1xyXG59KTsiLCJhcHAuZmlsdGVyKFwiYmFuZFwiLCBmdW5jdGlvbigpIHtcclxuXHRyZXR1cm4gZnVuY3Rpb24odHJhY2tJZCwgbGlzdCkge1xyXG5cdFx0dmFyIHJldHVyblZhbHVlID0gZmFsc2U7XHJcblx0XHRcclxuXHRcdGFuZ3VsYXIuZm9yRWFjaChsaXN0LCBmdW5jdGlvbihpZCwgaW5kZXgpIHtcclxuXHRcdFx0aWYoaWQgPT0gdHJhY2tJZCkge1xyXG5cdFx0XHRcdHJldHVyblZhbHVlID0gdHJ1ZTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0XHRyZXR1cm4gcmV0dXJuVmFsdWU7XHJcblx0fVxyXG59KTsiLCJhcHAuc2VydmljZShcImJhbmRTZXJ2aWNlXCIsIGZ1bmN0aW9uKCkge1xyXG5cdHZhciBzdmMgPSB0aGlzO1xyXG5cdHN2Yy50ZXN0VmFsdWUgPSBcIlRoaXMgdmFsdWUgaXMgZnJvbSBhIHNlcnZpY2UhXCI7XHJcblxyXG5cdHN2Yy50cmFja0FycmF5ID0gW107XHJcblxyXG5cdFxyXG5cclxuXHJcblxyXG5cclxuXHRzdmMudGVzdEZ1bmN0aW9uID0gZnVuY3Rpb24oKSB7XHJcblx0XHRhbGVydChcIlRlc3QgZnVuY3Rpb24gY2FsbGVkIGZyb20gaW5zaWRlIHNlcnZpY2UhXCIpO1xyXG5cdH1cclxufSkiLCJhcHAuc2VydmljZShcImZpbHRlclNlcnZpY2VcIiwgZnVuY3Rpb24oaW5zdHJ1bWVudFNlcnZpY2UpIHtcclxuXHRcclxuXHR2YXIgc3ZjID0gdGhpcztcclxuXHR2YXIgaW5zdFN2YyA9IGluc3RydW1lbnRTZXJ2aWNlO1xyXG5cclxuXHJcblx0c3ZjLmNyZWF0ZUZpbHRlckRhdGEgPSBmdW5jdGlvbigpXHJcblx0e1xyXG5cdFx0c3ZjLmZpbHRlckRhdGEgPSB7XHRcImFydGlzdFwiOiBcIlwiLFxyXG5cdFx0XHRcdFx0XHRcdFwidGl0bGVcIjogXCJcIixcclxuXHRcdFx0XHRcdFx0XHR9O1xyXG5cclxuXHRcdGFuZ3VsYXIuZm9yRWFjaChpbnN0U3ZjLmluc3RydW1lbnRzLCBmdW5jdGlvbih2YWx1ZSwga2V5KVxyXG5cdFx0e1xyXG5cdFx0XHRzdmMuZmlsdGVyRGF0YVt2YWx1ZS5pZF0gPSB0cnVlO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBfaW5pdCgpIHtcclxuXHRcdHN2Yy5jcmVhdGVGaWx0ZXJEYXRhKCk7XHJcblx0fVxyXG5cclxuXHRfaW5pdCgpO1xyXG59KSIsImFwcC5zZXJ2aWNlKFwiaW5zdHJ1bWVudFNlcnZpY2VcIiwgZnVuY3Rpb24oJGh0dHApIHtcclxuXHRcclxuXHQvL0dsb2JhbHNcclxuXHR2YXIgc3ZjID0gdGhpcztcclxuXHJcblx0Ly9Qcml2YXRlIGZ1bmN0aW9uc1xyXG5cdGZ1bmN0aW9uIGdldERhdGEgKHVybCwgb3B0aW9ucykge1xyXG5cclxuXHRcdCFvcHRpb25zID8gb3B0aW9ucyA9IHt9IDogXCJcIjtcclxuXHJcblx0XHRyZXR1cm4gJGh0dHAuZ2V0KHVybCwgb3B0aW9ucylcclxuXHR9XHJcblxyXG5cdC8vU3ZjIGZ1bmN0aW9uc1xyXG5cdHN2Yy5nZXRJbnN0cnVtZW50cyA9IGZ1bmN0aW9uICgpIHtcclxuXHJcblx0XHR2YXIgdXJsID0gQ09OU1RBTlRTLkFQSV9CQVNFX1VSTCArIFwiL2luc3RydW1lbnRzXCI7XHJcblx0XHRcclxuXHRzdmMuaW5zdHJ1bWVudHMgPSBnZXREYXRhKHVybCk7XHJcblx0fVxyXG5cclxuXHRzdmMuaW5zdHJ1bWVudHMgPSBbe1xyXG5cdFx0XHRcdFx0XHRcdFwibmFtZVwiOlwiTGVhZC1ndWl0YXJcIixcclxuXHRcdFx0XHRcdFx0XHRcImlkXCI6MVxyXG5cdFx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XCJuYW1lXCI6XCJEcnVtXCIsXHJcblx0XHRcdFx0XHRcdFx0XCJpZFwiOjJcclxuXHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFwibmFtZVwiOlwiQmFzc1wiLFxyXG5cdFx0XHRcdFx0XHRcdFwiaWRcIjozXHJcblx0XHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcIm5hbWVcIjpcIktleXNcIixcclxuXHRcdFx0XHRcdFx0XHRcImlkXCI6NFxyXG5cdFx0XHRcdFx0XHR9XTtcclxufSkiLCJhcHAuc2VydmljZShcImxvZ2luU2VydmljZVwiLCBmdW5jdGlvbigkaHR0cCkge1x0XHJcblx0dmFyIHN2YyA9IHRoaXM7XHJcblxyXG5cdHN2Yy5nZXRVc2VyID0gZnVuY3Rpb24oKVxyXG5cdHtcclxuXHRcdHJldHVybiAkaHR0cC5nZXQoQ09OU1RBTlRTLkFQSV9CQVNFX1VSTCArIFwiL3VzZXJcIik7XHJcblx0fVxyXG59KSIsImFwcC5zZXJ2aWNlKFwic29sb1NlcnZpY2VcIiwgZnVuY3Rpb24oJGh0dHApIHtcclxuXHRcclxuXHQvL0dsb2JhbHNcclxuXHR2YXIgc3ZjID0gdGhpcztcclxuXHJcblx0Ly9Qcml2YXRlIGZ1bmN0aW9uc1xyXG5cdGZ1bmN0aW9uIGdldERhdGEgKHVybCwgb3B0aW9ucykge1xyXG5cclxuXHRcdCFvcHRpb25zID8gb3B0aW9ucyA9IHt9IDogXCJcIjtcclxuXHJcblx0XHRyZXR1cm4gJGh0dHAuZ2V0KHVybCwgb3B0aW9ucylcclxuXHR9XHJcblxyXG5cdC8vU3ZjIGZ1bmN0aW9uc1xyXG5cdHN2Yy5nZXRUcmFja3MgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG5cdFx0dmFyIHVybCA9IENPTlNUQU5UUy5BUElfQkFTRV9VUkwgKyBcIi90cmFja3NcIjtcclxuXHRcdFxyXG5cdFx0cmV0dXJuIGdldERhdGEodXJsKTtcclxuXHR9XHJcblxyXG5cdHN2Yy5nZXRUcmFja0J5SWQgPSBmdW5jdGlvbiAoaWQpIHtcclxuXHJcblx0XHR2YXIgdXJsID0gQ09OU1RBTlRTLkFQSV9CQVNFX1VSTCArIFwiL3RyYWNrcy9cIiArIGlkO1xyXG5cclxuXHRcdHJldHVybiBnZXREYXRhKHVybCk7XHJcblx0fVxyXG59KSIsImFwcC5kaXJlY3RpdmUoXCJkY2JIZWFkZXJcIiwgZnVuY3Rpb24oKSB7XHJcblx0cmV0dXJuIHtcclxuXHRcdHJlc3RyaWN0OiBcIkVcIixcclxuXHRcdHRlbXBsYXRlVXJsOiBcImFwcC9kaXJlY3RpdmVzL2RjYi1oZWFkZXIvZGNiLWhlYWRlci5odG1sXCIsXHJcblx0XHRyZXBsYWNlOiB0cnVlLFxyXG5cdFx0c2NvcGU6IHt9LFxyXG5cdFx0Y29udHJvbGxlckFzOiBcImhlYWRcIixcclxuXHRcdGNvbnRyb2xsZXI6IGZ1bmN0aW9uKGxvZ2luU2VydmljZSwgJGF1dGgsICRyb290U2NvcGUpIHtcclxuXHRcdFx0dmFyIHZtIFx0XHRcdD0gdGhpcztcclxuXHRcdFx0dmFyIGxvZ2luU3ZjIFx0PSBsb2dpblNlcnZpY2U7XHJcblxyXG5cdFx0XHRmdW5jdGlvbiBfaW5pdCgpIHtcclxuXHRcdFx0XHRpZigkYXV0aC5pc0F1dGhlbnRpY2F0ZWQoKSlcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHRsb2dpblN2Yy5nZXRVc2VyKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG5cdFx0XHRcdFx0XHQkcm9vdFNjb3BlLnVzZXJuYW1lID0gZGF0YS5kYXRhLnVzZXJuYW1lO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHR2bS52YWx1ZSA9IFwiVGhpcyBpcyBhIGRpcmVjdGl2ZSB0ZXN0IHZhbHVlIVwiO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR2bS5zaG93TG9naW4gPSBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0JCgnI2xvZ2luX21vZGFsJykubW9kYWwoKTtcclxuXHRcdFx0XHQkKCcjbG9naW5fbW9kYWwnKS5tb2RhbCgnb3BlbicpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR2bS5sb2dvdXQgPSBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0JGF1dGgubG9nb3V0KCk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHZtLnNob3dSZWdpc3RlciA9IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0XHQkKCcjcmVnaXN0ZXJfbW9kYWwnKS5tb2RhbCgpO1xyXG5cdFx0XHRcdCQoJyNyZWdpc3Rlcl9tb2RhbCcpLm1vZGFsKCdvcGVuJyk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHZtLmlzQXV0aGVudGljYXRlZCA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHJldHVybiAkYXV0aC5pc0F1dGhlbnRpY2F0ZWQoKTtcclxuXHRcdFx0fTtcclxuXHJcblx0XHRcdF9pbml0KCk7XHJcblx0XHR9XHJcblx0fVxyXG59KSIsImFwcC5kaXJlY3RpdmUoXCJkY2JMb2dpblwiLCBmdW5jdGlvbigpIHtcclxuXHRyZXR1cm4ge1xyXG5cdFx0cmVzdHJpY3Q6IFwiRVwiLFxyXG5cdFx0dGVtcGxhdGVVcmw6IFwiYXBwL2RpcmVjdGl2ZXMvZGNiLWxvZ2luL2RjYi1sb2dpbi5odG1sXCIsXHJcblx0XHRyZXBsYWNlOiB0cnVlLFxyXG5cdFx0c2NvcGU6IHt9LFxyXG5cdFx0Y29udHJvbGxlckFzOiBcImxvZ2luXCIsXHJcblx0XHRjb250cm9sbGVyOiBmdW5jdGlvbigkYXV0aCwgbG9naW5TZXJ2aWNlLCAkcm9vdFNjb3BlKSB7XHJcblx0XHRcdHZhciB2bSBcdFx0XHQ9IHRoaXM7XHJcblx0XHRcdHZhciBsb2dpblN2YyBcdD0gbG9naW5TZXJ2aWNlO1xyXG5cdFx0XHR2YXIgdGFyZ2V0IFx0XHQ9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dpbi1zcGlubmVyJyk7XHJcblxyXG5cdFx0XHR2YXIgb3B0cyA9IHtcclxuXHQgIFx0XHRcdGxpbmVzOiAxMyAvLyBUaGUgbnVtYmVyIG9mIGxpbmVzIHRvIGRyYXdcclxuXHRcdFx0XHQsIGxlbmd0aDogMjggLy8gVGhlIGxlbmd0aCBvZiBlYWNoIGxpbmVcclxuXHRcdFx0XHQsIHdpZHRoOiAxNCAvLyBUaGUgbGluZSB0aGlja25lc3NcclxuXHRcdFx0XHQsIHJhZGl1czogNDIgLy8gVGhlIHJhZGl1cyBvZiB0aGUgaW5uZXIgY2lyY2xlXHJcblx0XHRcdFx0LCBzY2FsZTogMC40IC8vIFNjYWxlcyBvdmVyYWxsIHNpemUgb2YgdGhlIHNwaW5uZXJcclxuXHRcdFx0XHQsIGNvcm5lcnM6IDEgLy8gQ29ybmVyIHJvdW5kbmVzcyAoMC4uMSlcclxuXHRcdFx0XHQsIGNvbG9yOiAnIzAwMCcgLy8gI3JnYiBvciAjcnJnZ2JiIG9yIGFycmF5IG9mIGNvbG9yc1xyXG5cdFx0XHRcdCwgb3BhY2l0eTogMC4yNSAvLyBPcGFjaXR5IG9mIHRoZSBsaW5lc1xyXG5cdFx0XHRcdCwgcm90YXRlOiAwIC8vIFRoZSByb3RhdGlvbiBvZmZzZXRcclxuXHRcdFx0XHQsIGRpcmVjdGlvbjogMSAvLyAxOiBjbG9ja3dpc2UsIC0xOiBjb3VudGVyY2xvY2t3aXNlXHJcblx0XHRcdFx0LCBzcGVlZDogMSAvLyBSb3VuZHMgcGVyIHNlY29uZFxyXG5cdFx0XHRcdCwgdHJhaWw6IDYwIC8vIEFmdGVyZ2xvdyBwZXJjZW50YWdlXHJcblx0XHRcdFx0LCBmcHM6IDIwIC8vIEZyYW1lcyBwZXIgc2Vjb25kIHdoZW4gdXNpbmcgc2V0VGltZW91dCgpIGFzIGEgZmFsbGJhY2sgZm9yIENTU1xyXG5cdFx0XHRcdCwgekluZGV4OiAyZTkgLy8gVGhlIHotaW5kZXggKGRlZmF1bHRzIHRvIDIwMDAwMDAwMDApXHJcblx0XHRcdFx0LCBjbGFzc05hbWU6ICdzcGlubmVyJyAvLyBUaGUgQ1NTIGNsYXNzIHRvIGFzc2lnbiB0byB0aGUgc3Bpbm5lclxyXG5cdFx0XHRcdCwgdG9wOiAnNjAlJyAvLyBUb3AgcG9zaXRpb24gcmVsYXRpdmUgdG8gcGFyZW50XHJcblx0XHRcdFx0LCBsZWZ0OiAnNTAlJyAvLyBMZWZ0IHBvc2l0aW9uIHJlbGF0aXZlIHRvIHBhcmVudFxyXG5cdFx0XHRcdCwgc2hhZG93OiBmYWxzZSAvLyBXaGV0aGVyIHRvIHJlbmRlciBhIHNoYWRvd1xyXG5cdFx0XHRcdCwgaHdhY2NlbDogZmFsc2UgLy8gV2hldGhlciB0byB1c2UgaGFyZHdhcmUgYWNjZWxlcmF0aW9uXHJcblx0XHRcdFx0LCBwb3NpdGlvbjogJ2Fic29sdXRlJyAvLyBFbGVtZW50IHBvc2l0aW9uaW5nXHJcblx0XHRcdH1cclxuXHJcblx0ICAgICAgICB2bS5sb2dpbiA9IGZ1bmN0aW9uKCkge1xyXG5cdCAgICAgICAgXHR2YXIgc3Bpbm5lciA9IG5ldyBTcGlubmVyKG9wdHMpLnNwaW4odGFyZ2V0KTtcclxuXHQgICAgICAgIFx0dm0ubG9hZGluZyBcdD0gdHJ1ZTtcclxuXHJcblx0ICAgICAgICAgICAgdmFyIGNyZWRlbnRpYWxzID0ge1xyXG5cdCAgICAgICAgICAgICAgICBlbWFpbDogdm0uZW1haWwsXHJcblx0ICAgICAgICAgICAgICAgIHBhc3N3b3JkOiB2bS5wYXNzd29yZFxyXG5cdCAgICAgICAgICAgIH1cclxuXHQgICAgICAgICAgICBcclxuXHQgICAgICAgICAgICAkYXV0aC5sb2dpbihjcmVkZW50aWFscykudGhlbihmdW5jdGlvbihkYXRhKSB7XHJcblx0ICAgICAgICAgICAgXHQvLyBBdXRoZW50aWNhdGlvbiBzdWNjZXNzXHJcblx0ICAgICAgICAgICAgXHRzcGlubmVyLnN0b3AoKTtcclxuXHQgICAgICAgICAgICBcdHZtLmxvYWRpbmcgPSBmYWxzZTtcclxuXHQgICAgICAgICAgICBcdCQoJyNsb2dpbl9tb2RhbCcpLm1vZGFsKCk7XHJcblx0XHRcdFx0XHQkKCcjbG9naW5fbW9kYWwnKS5tb2RhbCgnY2xvc2UnKTtcclxuXHJcblx0XHRcdFx0XHRsb2dpblN2Yy5nZXRVc2VyKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG5cdFx0XHRcdFx0XHQkcm9vdFNjb3BlLnVzZXJuYW1lID0gZGF0YS5kYXRhLnVzZXJuYW1lO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0ICAgICAgICAgICAgfSwgXHJcblx0ICAgICAgICAgICAgZnVuY3Rpb24oZXJyb3Ipe1xyXG5cdCAgICAgICAgICAgIFx0Ly8gQXV0aGVudGljYXRpb24gZmFpbGVkXHJcblx0ICAgICAgICAgICAgXHRzcGlubmVyLnN0b3AoKTtcclxuXHQgICAgICAgICAgICBcdHZtLmxvYWRpbmcgPSBmYWxzZTtcclxuXHQgICAgICAgICAgICBcdGNvbnNvbGUubG9nKGVycm9yKTtcclxuXHQgICAgICAgICAgICB9KTtcclxuXHQgICAgICAgIH1cclxuXHRcdH1cclxuXHR9XHJcbn0pIiwiYXBwLmRpcmVjdGl2ZShcImRjYlJlZ2lzdGVyXCIsIGZ1bmN0aW9uKCkge1xyXG5cdHJldHVybiB7XHJcblx0XHRyZXN0cmljdDogXCJFXCIsXHJcblx0XHR0ZW1wbGF0ZVVybDogXCJhcHAvZGlyZWN0aXZlcy9kY2ItcmVnaXN0ZXIvZGNiLXJlZ2lzdGVyLmh0bWxcIixcclxuXHRcdHJlcGxhY2U6IHRydWUsXHJcblx0XHRzY29wZToge30sXHJcblx0XHRjb250cm9sbGVyQXM6IFwicmVnaXN0ZXJcIixcclxuXHRcdGNvbnRyb2xsZXI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR2YXIgdm0gPSB0aGlzO1xyXG5cdFx0XHRcclxuXHRcdH1cclxuXHR9XHJcbn0pIl19
